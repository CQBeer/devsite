<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Event bus module design document | NULS</title>
    <meta name="description" content="NULS">
    
    
    <link rel="preload" href="/assets/css/0.styles.e4f4c31f.css" as="style"><link rel="preload" href="/assets/js/app.9c98b51a.js" as="script"><link rel="preload" href="/assets/js/20.d78122c0.js" as="script"><link rel="prefetch" href="/assets/js/10.74e2c17d.js"><link rel="prefetch" href="/assets/js/11.4f7fa307.js"><link rel="prefetch" href="/assets/js/12.03d27bd6.js"><link rel="prefetch" href="/assets/js/13.e407f4bb.js"><link rel="prefetch" href="/assets/js/14.29a73e0d.js"><link rel="prefetch" href="/assets/js/15.12980442.js"><link rel="prefetch" href="/assets/js/16.6fb58e9f.js"><link rel="prefetch" href="/assets/js/17.12b0b65c.js"><link rel="prefetch" href="/assets/js/18.ef8a3f7f.js"><link rel="prefetch" href="/assets/js/19.75c38d33.js"><link rel="prefetch" href="/assets/js/21.32857727.js"><link rel="prefetch" href="/assets/js/22.c21dbed1.js"><link rel="prefetch" href="/assets/js/23.a81bb94d.js"><link rel="prefetch" href="/assets/js/24.02649ec3.js"><link rel="prefetch" href="/assets/js/25.f10130fb.js"><link rel="prefetch" href="/assets/js/26.c0d41e09.js"><link rel="prefetch" href="/assets/js/27.60a0d6a1.js"><link rel="prefetch" href="/assets/js/28.0adb14e7.js"><link rel="prefetch" href="/assets/js/29.9cec7237.js"><link rel="prefetch" href="/assets/js/3.d2acb6a3.js"><link rel="prefetch" href="/assets/js/30.d68bbdb0.js"><link rel="prefetch" href="/assets/js/31.dcf88b81.js"><link rel="prefetch" href="/assets/js/32.cf8542a3.js"><link rel="prefetch" href="/assets/js/33.3fc7a331.js"><link rel="prefetch" href="/assets/js/34.cba6b9c8.js"><link rel="prefetch" href="/assets/js/35.494fa2be.js"><link rel="prefetch" href="/assets/js/36.c3ab37a4.js"><link rel="prefetch" href="/assets/js/37.e0788960.js"><link rel="prefetch" href="/assets/js/38.9a48ef21.js"><link rel="prefetch" href="/assets/js/39.e6668e35.js"><link rel="prefetch" href="/assets/js/4.38f6b44d.js"><link rel="prefetch" href="/assets/js/40.6307c937.js"><link rel="prefetch" href="/assets/js/41.f7a113ed.js"><link rel="prefetch" href="/assets/js/42.34dd4254.js"><link rel="prefetch" href="/assets/js/43.bdabefb4.js"><link rel="prefetch" href="/assets/js/44.a831de78.js"><link rel="prefetch" href="/assets/js/45.b78342c8.js"><link rel="prefetch" href="/assets/js/46.771b0e34.js"><link rel="prefetch" href="/assets/js/47.369e4ef1.js"><link rel="prefetch" href="/assets/js/48.4bb8b947.js"><link rel="prefetch" href="/assets/js/49.48c4fd4a.js"><link rel="prefetch" href="/assets/js/5.1bd5ef5e.js"><link rel="prefetch" href="/assets/js/50.56f075fb.js"><link rel="prefetch" href="/assets/js/51.dae25c4d.js"><link rel="prefetch" href="/assets/js/52.9e4bbc29.js"><link rel="prefetch" href="/assets/js/53.7db30b4d.js"><link rel="prefetch" href="/assets/js/54.15d189c5.js"><link rel="prefetch" href="/assets/js/55.5afc4da7.js"><link rel="prefetch" href="/assets/js/56.62dc5cc0.js"><link rel="prefetch" href="/assets/js/57.3909c900.js"><link rel="prefetch" href="/assets/js/58.431966d2.js"><link rel="prefetch" href="/assets/js/59.a125ac7f.js"><link rel="prefetch" href="/assets/js/6.af3065c2.js"><link rel="prefetch" href="/assets/js/60.e35ab80a.js"><link rel="prefetch" href="/assets/js/61.bda180cc.js"><link rel="prefetch" href="/assets/js/62.d9fb101c.js"><link rel="prefetch" href="/assets/js/63.296c0190.js"><link rel="prefetch" href="/assets/js/64.5bc15caf.js"><link rel="prefetch" href="/assets/js/65.93ccf818.js"><link rel="prefetch" href="/assets/js/66.48d53328.js"><link rel="prefetch" href="/assets/js/67.fcb548e5.js"><link rel="prefetch" href="/assets/js/68.f03e37a5.js"><link rel="prefetch" href="/assets/js/69.49b218e1.js"><link rel="prefetch" href="/assets/js/7.f2ea7c13.js"><link rel="prefetch" href="/assets/js/70.57c0fd61.js"><link rel="prefetch" href="/assets/js/71.3fb0077a.js"><link rel="prefetch" href="/assets/js/72.78c314bd.js"><link rel="prefetch" href="/assets/js/73.c4e49878.js"><link rel="prefetch" href="/assets/js/74.db283428.js"><link rel="prefetch" href="/assets/js/75.772f3f5f.js"><link rel="prefetch" href="/assets/js/76.7d220a79.js"><link rel="prefetch" href="/assets/js/77.02bebb23.js"><link rel="prefetch" href="/assets/js/78.0fa6a6e6.js"><link rel="prefetch" href="/assets/js/79.b8638d8d.js"><link rel="prefetch" href="/assets/js/8.0c614372.js"><link rel="prefetch" href="/assets/js/80.c5c125e0.js"><link rel="prefetch" href="/assets/js/81.d763c351.js"><link rel="prefetch" href="/assets/js/82.32342395.js"><link rel="prefetch" href="/assets/js/83.91cd2f41.js"><link rel="prefetch" href="/assets/js/84.fe83947a.js"><link rel="prefetch" href="/assets/js/85.952d0dc9.js"><link rel="prefetch" href="/assets/js/86.8908ae63.js"><link rel="prefetch" href="/assets/js/87.4ef79520.js"><link rel="prefetch" href="/assets/js/88.628f6d6d.js"><link rel="prefetch" href="/assets/js/89.f0d1d7cf.js"><link rel="prefetch" href="/assets/js/9.70325410.js"><link rel="prefetch" href="/assets/js/90.9f8cff5b.js"><link rel="prefetch" href="/assets/js/91.12f24a21.js"><link rel="prefetch" href="/assets/js/92.2b594ff6.js"><link rel="prefetch" href="/assets/js/93.fffd120d.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.2192dbe7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4f4c31f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">NULS</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/NULSInfrastructure/eventBusModuleDesign.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/NULSInfrastructure/eventBusModuleDesign.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/nuls-io/devsite" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/NULSInfrastructure/eventBusModuleDesign.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/NULSInfrastructure/eventBusModuleDesign.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/nuls-io/devsite" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Overview</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Users Guide</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Community</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Launch NULS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Quickly Building A Chain</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Underlying Design Of NULS</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/NULSInfrastructure/NULS2.0Introduction.html" class="sidebar-link">NULS 2.0 Introduction</a></li><li><a href="/NULSInfrastructure/networkModuleDesign.html" class="sidebar-link">Network module design document</a></li><li><a href="/NULSInfrastructure/eventBusModuleDesign.html" class="active sidebar-link">Event bus module design document</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_1-overall-description" class="sidebar-link">1. Overall description</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_1-1-module-overview" class="sidebar-link">1.1 Module Overview</a></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_1-2-architecture" class="sidebar-link">1.2 Architecture</a></li></ul></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_2-functional-design" class="sidebar-link">2. functional design</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_2-1-functional-architecture" class="sidebar-link">2.1 Functional Architecture</a></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_2-2-module-service" class="sidebar-link">2.2 Module Service</a></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_2-3-module-internal-function" class="sidebar-link">2.3 Module internal function</a></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_2-4-event-bus-process" class="sidebar-link">2.4 Event Bus Process</a></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_2-5-business-logic" class="sidebar-link">2.5 Business Logic</a></li></ul></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_3-interface-design" class="sidebar-link">3. Interface Design</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_3-1-module-interface" class="sidebar-link">3.1 Module Interface</a></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_3-2-function-interface" class="sidebar-link">3.2 Function Interface</a></li></ul></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_4-description-of-the-event" class="sidebar-link">4. Description of the event</a></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_5-agreement" class="sidebar-link">5. agreement</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_5-1-network-communication-protocol" class="sidebar-link">5.1 Network Communication Protocol</a></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_5-2-trading-agreement" class="sidebar-link">5.2 Trading Agreement</a></li></ul></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_6-module-configuration" class="sidebar-link">6. Module Configuration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_6-1-configuration-instructions" class="sidebar-link">6.1 Configuration Instructions</a></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_6-2-module-dependencies" class="sidebar-link">6.2 Module Dependencies</a></li></ul></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_7-java-specific-design" class="sidebar-link">7. Java-specific design</a></li><li class="sidebar-sub-header"><a href="/NULSInfrastructure/eventBusModuleDesign.html#_8-supplementary-content" class="sidebar-link">8. supplementary content</a></li></ul></li><li><a href="/NULSInfrastructure/generalProtocol.html" class="sidebar-link">Protocol design</a></li><li><a href="/NULSInfrastructure/accountModuleDesign.html" class="sidebar-link">Account module design document</a></li><li><a href="/NULSInfrastructure/ledgerModuleDesign.html" class="sidebar-link">Account Ledger module design document</a></li><li><a href="/NULSInfrastructure/blockModuleDesign.html" class="sidebar-link">Block management module design documents</a></li><li><a href="/NULSInfrastructure/chainModuleDesign.html" class="sidebar-link">Chain management module design document</a></li><li><a href="/NULSInfrastructure/consensusModuleDesign.html" class="sidebar-link">Consensus module design document</a></li><li><a href="/NULSInfrastructure/rpcToolWebsocketDesign.html" class="sidebar-link">RPC-TOOL design document</a></li><li><a href="/NULSInfrastructure/interfaceStandard.html" class="sidebar-link">JSON-RPC Interface interaction format and specification</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Smart Contracts</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Developer Tools</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>NIPs</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>NULS Portal</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="event-bus-module-design-document"><a href="#event-bus-module-design-document" aria-hidden="true" class="header-anchor">#</a> Event bus module design document</h1> <p>[TOC]</p> <h2 id="_1-overall-description"><a href="#_1-overall-description" aria-hidden="true" class="header-anchor">#</a> 1. Overall description</h2> <h3 id="_1-1-module-overview"><a href="#_1-1-module-overview" aria-hidden="true" class="header-anchor">#</a> 1.1 Module Overview</h3> <h4 id="_1-1-1-why-should-i-have-the-event-bus-module"><a href="#_1-1-1-why-should-i-have-the-event-bus-module" aria-hidden="true" class="header-anchor">#</a> 1.1.1 Why should I have the Event Bus module?</h4> <blockquote><p>The Event Bus Module is a functional module designed to receive and notify processing module events, managing all module events.</p></blockquote> <h4 id="_1-1-2-what-is-the-event-bus"><a href="#_1-1-2-what-is-the-event-bus" aria-hidden="true" class="header-anchor">#</a> 1.1.2 What is the &quot;Event Bus&quot;?</h4> <blockquote><p>Provide event subscription, receiving, sending and other functions, which is an event transfer station between modules</p></blockquote> <h4 id="_1-1-3-positioning-of-event-bus-in-the-system"><a href="#_1-1-3-positioning-of-event-bus-in-the-system" aria-hidden="true" class="header-anchor">#</a> 1.1.3 Positioning of Event Bus in the System</h4> <blockquote><p>The event module is an edge system that provides some major asynchronous messaging, which means that even without an event bus, the system can operate normally, is lightweight, and does not depend on other module systems.</p></blockquote> <h3 id="_1-2-architecture"><a href="#_1-2-architecture" aria-hidden="true" class="header-anchor">#</a> 1.2 Architecture</h3> <p><img src="/assets/img/event-bus-module.18c5a6f0.png" alt="event-bus-module"></p> <ul><li>The event bus module mainly contains 2 parts of interactive logic:
  - Microservice registration and service information acquisition with the system core module.
  - Event message creation, subscription, and forwarding management with other base modules.</li></ul> <h2 id="_2-functional-design"><a href="#_2-functional-design" aria-hidden="true" class="header-anchor">#</a> 2. functional design</h2> <h3 id="_2-1-functional-architecture"><a href="#_2-1-functional-architecture" aria-hidden="true" class="header-anchor">#</a> 2.1 Functional Architecture</h3> <p><img src="/assets/img/event-bus-content.23c1f972.png" alt="event-bus-content"></p> <h3 id="_2-2-module-service"><a href="#_2-2-module-service" aria-hidden="true" class="header-anchor">#</a> 2.2 Module Service</h3> <p><img src="/assets/img/event-bus-model.a7412672.png" alt="event-bus-model"></p> <blockquote><p>This module provides event subscriptions, event forwarding</p></blockquote> <h4 id="_2-2-1-modifying-system-operating-parameters"><a href="#_2-2-1-modifying-system-operating-parameters" aria-hidden="true" class="header-anchor">#</a> 2.2.1 Modifying system operating parameters</h4> <blockquote><p>Only rely on the core system, the core system can start, stop, modify parameters, etc. of the event module system,</p></blockquote> <h3 id="_2-3-module-internal-function"><a href="#_2-3-module-internal-function" aria-hidden="true" class="header-anchor">#</a> 2.3 Module internal function</h3> <p><img src="/assets/img/event-bus-function.8044546e.png" alt="event-bus-function"></p> <blockquote><p>Module internal work mainly includes, subscription manager, event manager, and forwarding manager.</p></blockquote> <ul><li>Microservice interface information synchronization management
  - for synchronizing the service interface with the kernel service management module</li> <li>Event Storage Management (eventBus)
  - Used to create event information, subscribe to other storage, and initialize the information when the module is restarted.</li> <li>Event subscription management (subscribe)
  - Maintain a &quot;configuration table&quot; for subscription events: including important parameters for all individual module subscriptions</li> <li>Event forwarding management (dispatcher)
  - The open interface is used for event reception, the receiving event is forwarded by subscription, and the forwarding call interface is obtained through the service information management interface.</li> <li>Function Interface Management (rpc)
  - Open query interface for external query</li></ul> <h3 id="_2-4-event-bus-process"><a href="#_2-4-event-bus-process" aria-hidden="true" class="header-anchor">#</a> 2.4 Event Bus Process</h3> <ul><li>Event processing timing</li></ul> <p><img src="/assets/img/event-bus-seq-flow.2de08cda.png" alt="event-bus-seq-flow"></p> <ul><li>Event processing basic process</li></ul> <p><img src="/assets/img/event-bus-main-flow.c97c465a.png" alt="event-bus-main-flow"></p> <h3 id="_2-5-business-logic"><a href="#_2-5-business-logic" aria-hidden="true" class="header-anchor">#</a> 2.5 Business Logic</h3> <blockquote><p>Exception logic processing in case of event forwarding failure (such as network reason), according to the following two logics:</p></blockquote> <ul><li><ol><li>Retaining event calls Repeat calls by queue until the forwarding is successful.</li></ol></li> <li><ol start="2"><li>Discard it directly after trying many times. (Tentatively 5 times) Retry every 10 seconds.</li></ol></li></ul> <h2 id="_3-interface-design"><a href="#_3-interface-design" aria-hidden="true" class="header-anchor">#</a> 3. Interface Design</h2> <h3 id="_3-1-module-interface"><a href="#_3-1-module-interface" aria-hidden="true" class="header-anchor">#</a> 3.1 Module Interface</h3> <h4 id="_3-1-1-event-theme-subscription"><a href="#_3-1-1-event-theme-subscription" aria-hidden="true" class="header-anchor">#</a> 3.1.1 Event Theme Subscription</h4> <blockquote><p>cmd: subscribe</p></blockquote> <h5 id="parameter-description-request-body"><a href="#parameter-description-request-body" aria-hidden="true" class="header-anchor">#</a> Parameter Description (Request body)</h5> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;cmd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;subscribe&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;min_version&quot;</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;params&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token string">&quot;app.nuls.network.bandwidth&quot;</span><span class="token punctuation">,</span>//topic event topic
    <span class="token string">&quot;moduleId&quot;</span> //moduleId subscriber module id
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="return-value-description-response-content"><a href="#return-value-description-response-content" aria-hidden="true" class="header-anchor">#</a> Return value description (Response content)</h5> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token number">1.2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;reponse message.&quot;</span><span class="token punctuation">,</span> // ​​information on failure
  <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;app_secret&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxxxxxxxxxxx&quot;</span> // app_secret<span class="token punctuation">,</span> temporarily not needed<span class="token punctuation">,</span> may need to be verified later if it is not required to be called locally
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_3-1-2-event-unsubscribe"><a href="#_3-1-2-event-unsubscribe" aria-hidden="true" class="header-anchor">#</a> 3.1.2 Event Unsubscribe</h4> <blockquote><p>cmd: unsubscribe</p></blockquote> <h5 id="parameter-description-request-body-2"><a href="#parameter-description-request-body-2" aria-hidden="true" class="header-anchor">#</a> Parameter Description (request body)</h5> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;cmd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;unsubscribe&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;min_version&quot;</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;params&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token string">&quot;app.nuls.network.bandwidth&quot;</span><span class="token punctuation">,</span> //topic event topic
    <span class="token string">&quot;moduleId&quot;</span> //moduleId subscriber module id
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="return-value-description-response-content-2"><a href="#return-value-description-response-content-2" aria-hidden="true" class="header-anchor">#</a> Return value description: (response content)</h5> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token number">1.2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;reponse message.&quot;</span><span class="token punctuation">,</span> // ​​information on failure
  <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_3-1-3-event-sending-automatically-create-topic"><a href="#_3-1-3-event-sending-automatically-create-topic" aria-hidden="true" class="header-anchor">#</a> 3.1.3 Event Sending [Automatically Create Topic]</h4> <blockquote><p>Do you keep a certain amount of time when no one is subscribed?</p></blockquote> <blockquote><p>cmd: send</p></blockquote> <h5 id="parameter-description-request-body-3"><a href="#parameter-description-request-body-3" aria-hidden="true" class="header-anchor">#</a> Parameter description (request body)</h5> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
 <span class="token property">&quot;cmd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;send&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;min_version&quot;</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
 <span class="token property">&quot;params&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
   <span class="token string">&quot;app.nuls.network.bandwidth&quot;</span><span class="token punctuation">,</span>//topic event topic
   <span class="token string">&quot;moduleId&quot;</span><span class="token punctuation">,</span> //moduleId subscriber module id
   <span class="token punctuation">{</span><span class="token property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;data value&quot;</span><span class="token punctuation">}</span> // event to be sent<span class="token punctuation">,</span> jsonObj
 <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h5 id="return-value-description-response-content-3"><a href="#return-value-description-response-content-3" aria-hidden="true" class="header-anchor">#</a> return value description (response content)</h5> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token number">1.2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;reponse message.&quot;</span><span class="token punctuation">,</span> // ​​information on failure
  <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_3-1-4-event-broadcast-push-push-or-dispatcher"><a href="#_3-1-4-event-broadcast-push-push-or-dispatcher" aria-hidden="true" class="header-anchor">#</a> 3.1.4 Event broadcast (push push or dispatcher)</h4> <blockquote><p>I need each interface to provide an interface when subscribing to events. I can call it when I broadcast. I am using multithreading to remove your interface. You need to return the correct code, otherwise there will be a retry mechanism.</p></blockquote> <h5 id="parameter-description-request-body-4"><a href="#parameter-description-request-body-4" aria-hidden="true" class="header-anchor">#</a> Parameter description (request body)</h5> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
 <span class="token property">&quot;cmd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dispatcher&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;min_version&quot;</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
 <span class="token property">&quot;params&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
   <span class="token punctuation">{</span><span class="token punctuation">}</span> //data event to be sent<span class="token punctuation">,</span> payload
 <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="return-value-description-response-content-4"><a href="#return-value-description-response-content-4" aria-hidden="true" class="header-anchor">#</a> return value description (response content)</h5> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token number">1.2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> // ​​must return correctly<span class="token punctuation">,</span> do not need to tell you whether the business logic is wrong<span class="token punctuation">,</span> as long as you receive it<span class="token punctuation">,</span> tell me that you have successfully received it.
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;reponse message.&quot;</span><span class="token punctuation">,</span> // ​​information on failure
  <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_3-2-function-interface"><a href="#_3-2-function-interface" aria-hidden="true" class="header-anchor">#</a> 3.2 Function Interface</h3> <blockquote><p>The functional interface is the interface provided to the interface and command line tools</p></blockquote> <h4 id="get-event-topic-information"><a href="#get-event-topic-information" aria-hidden="true" class="header-anchor">#</a> Get event topic information</h4> <blockquote><p>cmd: topics</p></blockquote> <h5 id="parameter-description-request-body-5"><a href="#parameter-description-request-body-5" aria-hidden="true" class="header-anchor">#</a> Parameter description (request body)</h5> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
 <span class="token property">&quot;cmd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;min_version&quot;</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
 <span class="token property">&quot;params&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="response-body-response-content"><a href="#response-body-response-content" aria-hidden="true" class="header-anchor">#</a> Response Body (response content)</h5> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token number">1.2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> // ​​must return correctly<span class="token punctuation">,</span> do not need to tell you whether the business logic is wrong<span class="token punctuation">,</span> as long as you receive it<span class="token punctuation">,</span> tell me that you have successfully received it.
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;reponse message.&quot;</span><span class="token punctuation">,</span> // ​​information on failure
  <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;topics&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
        <span class="token property">&quot;topic&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> //topic id
        <span class="token property">&quot;createTime&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> //Create time
        <span class="token property">&quot;moduleId&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> // theme creator (module<span class="token punctuation">)</span> Id
        <span class="token property">&quot;subscribes&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>//subscriber information
            <span class="token punctuation">{</span>
                <span class="token property">&quot;moduleId&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> //subscriber
                <span class="token property">&quot;subscribeTime&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span> //Subscription time
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="get-event-topic-information-including-all-event-information-on-this-topic-every-event-i-don-t-care-about"><a href="#get-event-topic-information-including-all-event-information-on-this-topic-every-event-i-don-t-care-about" aria-hidden="true" class="header-anchor">#</a> Get event topic information (including all event information on this topic?) Every event I don't care about.</h4> <blockquote><p>cmd : get_topic</p></blockquote> <h2 id="_4-description-of-the-event"><a href="#_4-description-of-the-event" aria-hidden="true" class="header-anchor">#</a> 4. Description of the event</h2> <blockquote><p>does not depend on any events</p></blockquote> <h2 id="_5-agreement"><a href="#_5-agreement" aria-hidden="true" class="header-anchor">#</a> 5. agreement</h2> <h3 id="_5-1-network-communication-protocol"><a href="#_5-1-network-communication-protocol" aria-hidden="true" class="header-anchor">#</a> 5.1 Network Communication Protocol</h3> <p>no</p> <h3 id="_5-2-trading-agreement"><a href="#_5-2-trading-agreement" aria-hidden="true" class="header-anchor">#</a> 5.2 Trading Agreement</h3> <h2 id="_6-module-configuration"><a href="#_6-module-configuration" aria-hidden="true" class="header-anchor">#</a> 6. Module Configuration</h2> <h3 id="_6-1-configuration-instructions"><a href="#_6-1-configuration-instructions" aria-hidden="true" class="header-anchor">#</a> 6.1 Configuration Instructions</h3> <blockquote><p>General support configuration, port, number of retries, retry time, thread pool size of default executor, network call timeout configuration, etc.</p></blockquote> <div class="language-yml line-numbers-mode"><pre class="language-text"><code>Server:
  Ip: 127.0.0.1 // local ip, used to provide services to other modules, you can not fill, the default is automatically obtained
  Port: 8080 //The port that provides the service, you can leave it blank, the default is automatically obtained.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_6-2-module-dependencies"><a href="#_6-2-module-dependencies" aria-hidden="true" class="header-anchor">#</a> 6.2 Module Dependencies</h3> <ul><li>Kernel module
  - Module registration
  - Module logout
  - Module status escalation (heartbeat)
  - Service interface data acquisition and timing update</li></ul> <h2 id="_7-java-specific-design"><a href="#_7-java-specific-design" aria-hidden="true" class="header-anchor">#</a> 7. Java-specific design</h2> <blockquote><p>Core object class definition, storing data structures, ...</p></blockquote> <h2 id="_8-supplementary-content"><a href="#_8-supplementary-content" aria-hidden="true" class="header-anchor">#</a> 8. supplementary content</h2> <blockquote><p>Required content not covered above</p></blockquote></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/nuls-io/devsite/edit/dev/docs/NULSInfrastructure/eventBusModuleDesign.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">1/11/2019, 1:47:19 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/NULSInfrastructure/networkModuleDesign.html" class="prev">
          Network module design document
        </a></span> <span class="next"><a href="/NULSInfrastructure/generalProtocol.html">
          Protocol design
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.9c98b51a.js" defer></script><script src="/assets/js/20.d78122c0.js" defer></script>
  </body>
</html>
