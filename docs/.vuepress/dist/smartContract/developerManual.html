<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>NULS Smart Contract Development Manual | NULS</title>
    <meta name="description" content="NULS">
    
    
    <link rel="preload" href="/assets/css/0.styles.e4f4c31f.css" as="style"><link rel="preload" href="/assets/js/app.9c98b51a.js" as="script"><link rel="preload" href="/assets/js/58.431966d2.js" as="script"><link rel="prefetch" href="/assets/js/10.74e2c17d.js"><link rel="prefetch" href="/assets/js/11.4f7fa307.js"><link rel="prefetch" href="/assets/js/12.03d27bd6.js"><link rel="prefetch" href="/assets/js/13.e407f4bb.js"><link rel="prefetch" href="/assets/js/14.29a73e0d.js"><link rel="prefetch" href="/assets/js/15.12980442.js"><link rel="prefetch" href="/assets/js/16.6fb58e9f.js"><link rel="prefetch" href="/assets/js/17.12b0b65c.js"><link rel="prefetch" href="/assets/js/18.ef8a3f7f.js"><link rel="prefetch" href="/assets/js/19.75c38d33.js"><link rel="prefetch" href="/assets/js/20.d78122c0.js"><link rel="prefetch" href="/assets/js/21.32857727.js"><link rel="prefetch" href="/assets/js/22.c21dbed1.js"><link rel="prefetch" href="/assets/js/23.a81bb94d.js"><link rel="prefetch" href="/assets/js/24.02649ec3.js"><link rel="prefetch" href="/assets/js/25.f10130fb.js"><link rel="prefetch" href="/assets/js/26.c0d41e09.js"><link rel="prefetch" href="/assets/js/27.60a0d6a1.js"><link rel="prefetch" href="/assets/js/28.0adb14e7.js"><link rel="prefetch" href="/assets/js/29.9cec7237.js"><link rel="prefetch" href="/assets/js/3.d2acb6a3.js"><link rel="prefetch" href="/assets/js/30.d68bbdb0.js"><link rel="prefetch" href="/assets/js/31.dcf88b81.js"><link rel="prefetch" href="/assets/js/32.cf8542a3.js"><link rel="prefetch" href="/assets/js/33.3fc7a331.js"><link rel="prefetch" href="/assets/js/34.cba6b9c8.js"><link rel="prefetch" href="/assets/js/35.494fa2be.js"><link rel="prefetch" href="/assets/js/36.c3ab37a4.js"><link rel="prefetch" href="/assets/js/37.e0788960.js"><link rel="prefetch" href="/assets/js/38.9a48ef21.js"><link rel="prefetch" href="/assets/js/39.e6668e35.js"><link rel="prefetch" href="/assets/js/4.38f6b44d.js"><link rel="prefetch" href="/assets/js/40.6307c937.js"><link rel="prefetch" href="/assets/js/41.f7a113ed.js"><link rel="prefetch" href="/assets/js/42.34dd4254.js"><link rel="prefetch" href="/assets/js/43.bdabefb4.js"><link rel="prefetch" href="/assets/js/44.a831de78.js"><link rel="prefetch" href="/assets/js/45.b78342c8.js"><link rel="prefetch" href="/assets/js/46.771b0e34.js"><link rel="prefetch" href="/assets/js/47.369e4ef1.js"><link rel="prefetch" href="/assets/js/48.4bb8b947.js"><link rel="prefetch" href="/assets/js/49.48c4fd4a.js"><link rel="prefetch" href="/assets/js/5.1bd5ef5e.js"><link rel="prefetch" href="/assets/js/50.56f075fb.js"><link rel="prefetch" href="/assets/js/51.dae25c4d.js"><link rel="prefetch" href="/assets/js/52.9e4bbc29.js"><link rel="prefetch" href="/assets/js/53.7db30b4d.js"><link rel="prefetch" href="/assets/js/54.15d189c5.js"><link rel="prefetch" href="/assets/js/55.5afc4da7.js"><link rel="prefetch" href="/assets/js/56.62dc5cc0.js"><link rel="prefetch" href="/assets/js/57.3909c900.js"><link rel="prefetch" href="/assets/js/59.a125ac7f.js"><link rel="prefetch" href="/assets/js/6.af3065c2.js"><link rel="prefetch" href="/assets/js/60.e35ab80a.js"><link rel="prefetch" href="/assets/js/61.bda180cc.js"><link rel="prefetch" href="/assets/js/62.d9fb101c.js"><link rel="prefetch" href="/assets/js/63.296c0190.js"><link rel="prefetch" href="/assets/js/64.5bc15caf.js"><link rel="prefetch" href="/assets/js/65.93ccf818.js"><link rel="prefetch" href="/assets/js/66.48d53328.js"><link rel="prefetch" href="/assets/js/67.fcb548e5.js"><link rel="prefetch" href="/assets/js/68.f03e37a5.js"><link rel="prefetch" href="/assets/js/69.49b218e1.js"><link rel="prefetch" href="/assets/js/7.f2ea7c13.js"><link rel="prefetch" href="/assets/js/70.57c0fd61.js"><link rel="prefetch" href="/assets/js/71.3fb0077a.js"><link rel="prefetch" href="/assets/js/72.78c314bd.js"><link rel="prefetch" href="/assets/js/73.c4e49878.js"><link rel="prefetch" href="/assets/js/74.db283428.js"><link rel="prefetch" href="/assets/js/75.772f3f5f.js"><link rel="prefetch" href="/assets/js/76.7d220a79.js"><link rel="prefetch" href="/assets/js/77.02bebb23.js"><link rel="prefetch" href="/assets/js/78.0fa6a6e6.js"><link rel="prefetch" href="/assets/js/79.b8638d8d.js"><link rel="prefetch" href="/assets/js/8.0c614372.js"><link rel="prefetch" href="/assets/js/80.c5c125e0.js"><link rel="prefetch" href="/assets/js/81.d763c351.js"><link rel="prefetch" href="/assets/js/82.32342395.js"><link rel="prefetch" href="/assets/js/83.91cd2f41.js"><link rel="prefetch" href="/assets/js/84.fe83947a.js"><link rel="prefetch" href="/assets/js/85.952d0dc9.js"><link rel="prefetch" href="/assets/js/86.8908ae63.js"><link rel="prefetch" href="/assets/js/87.4ef79520.js"><link rel="prefetch" href="/assets/js/88.628f6d6d.js"><link rel="prefetch" href="/assets/js/89.f0d1d7cf.js"><link rel="prefetch" href="/assets/js/9.70325410.js"><link rel="prefetch" href="/assets/js/90.9f8cff5b.js"><link rel="prefetch" href="/assets/js/91.12f24a21.js"><link rel="prefetch" href="/assets/js/92.2b594ff6.js"><link rel="prefetch" href="/assets/js/93.fffd120d.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.2192dbe7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4f4c31f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">NULS</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/smartContract/developerManual.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/smartContract/developerManual.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/nuls-io/devsite" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/smartContract/developerManual.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/smartContract/developerManual.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/nuls-io/devsite" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Overview</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Users Guide</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Community</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Launch NULS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Quickly Building A Chain</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Underlying Design Of NULS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Smart Contracts</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/smartContract/startSmartContract.html" class="sidebar-link">Quick Start</a></li><li><a href="/smartContract/developerManual.html" class="active sidebar-link">NULS Smart Contract Development Manual</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_1-introduction" class="sidebar-link">1. Introduction</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_2-development-environment" class="sidebar-link">2. Development environment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_2-1-setup-of-nuls-wallet" class="sidebar-link">2.1 Setup of NULS wallet</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_2-2-setup-of-jdk-8" class="sidebar-link">2.2 Setup of JDK 8</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_2-3-setup-of-intellij-idea" class="sidebar-link">2.3 Setup of IntelliJ IDEA</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_2-4-setup-of-nuls-smart-contract-plug-ins" class="sidebar-link">2.4 Setup of NULS smart contract plug-ins</a></li></ul></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_3-nuls-smart-contract-specifications-and-syntax" class="sidebar-link">3. NULS smart contract specifications and syntax</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_3-1-nuls-smart-contract-specifications" class="sidebar-link">3.1 NULS smart contract specifications</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_3-2-keywords" class="sidebar-link">3.2 Keywords</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_3-3-basic-syntax" class="sidebar-link">3.3 Basic syntax</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_3-4-available-class" class="sidebar-link">3.4 Available class</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_3-5-other-restrictions" class="sidebar-link">3.5 Other restrictions</a></li></ul></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_4-nuls-smart-contract-example" class="sidebar-link">4. Nuls smart contract example</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_5-nuls-contract-sdk" class="sidebar-link">5. NULS Contract SDK</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#io-nuls-contract-sdk-address" class="sidebar-link">io.nuls.contract.sdk.Address</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#io-nuls-contract-sdk-block" class="sidebar-link">io.nuls.contract.sdk.Block</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#io-nuls-contract-sdk-blockheader" class="sidebar-link">io.nuls.contract.sdk.BlockHeader</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#io-nuls-contract-sdk-contract" class="sidebar-link">io.nuls.contract.sdk.Contract</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#io-nuls-contract-sdk-event" class="sidebar-link">io.nuls.contract.sdk.Event</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#io-nuls-contract-sdk-msg" class="sidebar-link">io.nuls.contract.sdk.Msg</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#io-nuls-contract-sdk-utils" class="sidebar-link">io.nuls.contract.sdk.Utils</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#io-nuls-contract-sdk-annotation-payable" class="sidebar-link">io.nuls.contract.sdk.annotation.Payable</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#io-nuls-contract-sdk-annotation-required" class="sidebar-link">io.nuls.contract.sdk.annotation.Required</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#io-nuls-contract-sdk-annotation-view" class="sidebar-link">io.nuls.contract.sdk.annotation.View</a></li></ul></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-main-rpc-interface-of-smart-contract" class="sidebar-link">6. Main RPC interface of smart contract</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-1-create-smart-contract" class="sidebar-link">6.1 Create smart contract</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-2-estimate-the-gas-consumption-for-creating-smart-contract" class="sidebar-link">6.2 Estimate the gas consumption for creating smart contract</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-3-call-smart-contract" class="sidebar-link">6.3 Call smart contract</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-4-estimate-the-gas-consumption-for-calling-smart-contract-see-swagger-ui" class="sidebar-link">6.4 Estimate the gas consumption for calling smart contract (see Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-5-estimate-the-price-for-calling-smart-contract-see-swagger-ui" class="sidebar-link">6.5 Estimate the price for calling smart contract (see Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-6-terminate-smart-contract-see-swagger-ui" class="sidebar-link">6.6 Terminate smart contract (see Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-7-call-the-smart-contract-function-which-is-not-linked-to-blockchain-see-swagger-ui" class="sidebar-link">6.7 Call the smart contract function which is not linked to blockchain (see Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-8-get-the-implementation-results-of-smart-contract-see-swagger-ui" class="sidebar-link">6.8 Get the implementation results of smart contract (see Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-9-get-the-basic-information-of-smart-contract-see-swagger-ui" class="sidebar-link">6.9 Get the basic information of smart contract (see Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-10-verify-if-it-is-contract-address-see-swagger-ui" class="sidebar-link">6.10 Verify if it is contract address (see Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-11-get-the-nuls-balance-of-smart-contract-address-see-swagger-ui" class="sidebar-link">6.11 Get the NULS balance of smart contract address (see Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-12-get-the-transaction-details-of-smart-contract-see-swagger-ui" class="sidebar-link">6.12 Get the transaction details of smart contract (see Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-13-get-the-transaction-list-of-smart-contract-see-swagger-ui" class="sidebar-link">6.13 Get the transaction list of smart contract (see Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-14-inquire-contract-utxo-as-per-address-and-limit-see-swagger-ui" class="sidebar-link">6.14 Inquire contract UTXO as per address and limit (see Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-15-inquire-contract-utxo-as-per-address-and-amount-see-swagger-ui" class="sidebar-link">6.15 Inquire contract UTXO as per address and amount (see Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_6-16-transfer-amount-to-smart-contract-see-swagger-ui" class="sidebar-link">6.16 Transfer amount to smart contract (see Swagger UI)</a></li></ul></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_7-example" class="sidebar-link">7. Example</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_7-1-voting-smart-contract-code-segments-are-as-follows" class="sidebar-link">7.1 Voting smart contract code segments are as follows</a></li><li class="sidebar-sub-header"><a href="/smartContract/developerManual.html#_7-2-standard-token-smart-contract-code-segments" class="sidebar-link">7.2 Standard Token Smart contract code segments</a></li></ul></li></ul></li><li><a href="/smartContract/GUIForSmartContract.html" class="sidebar-link">User Document of Wallet Smart Contract</a></li><li><a href="/smartContract/ideaPlugin.html" class="sidebar-link">NULS IDEA Plugin User Manual</a></li><li><a href="/smartContract/NRC-20TokenStandard.html" class="sidebar-link">NRC-20 Token Standard</a></li><li><a href="/smartContract/smartContractFee.html" class="sidebar-link">Service charge for smart contracts</a></li><li><a href="/smartContract/randomImplementations.html" class="sidebar-link">Ways of creating random numbers for NULS</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Developer Tools</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>NIPs</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>NULS Portal</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="nuls-smart-contract-development-manual"><a href="#nuls-smart-contract-development-manual" aria-hidden="true" class="header-anchor">#</a> NULS Smart Contract Development Manual</h1> <h2 id="_1-introduction"><a href="#_1-introduction" aria-hidden="true" class="header-anchor">#</a> 1. Introduction</h2> <p>NULS smart contract is developed with Java, and it operates in NULS virtual machine. Not all Java features are applicable to contract development and the relevant restrictions are specified in section 3.</p> <h2 id="_2-development-environment"><a href="#_2-development-environment" aria-hidden="true" class="header-anchor">#</a> 2. Development environment</h2> <h3 id="_2-1-setup-of-nuls-wallet"><a href="#_2-1-setup-of-nuls-wallet" aria-hidden="true" class="header-anchor">#</a> 2.1 Setup of NULS wallet</h3> <h3 id="_2-2-setup-of-jdk-8"><a href="#_2-2-setup-of-jdk-8" aria-hidden="true" class="header-anchor">#</a> 2.2 Setup of JDK 8</h3> <h3 id="_2-3-setup-of-intellij-idea"><a href="#_2-3-setup-of-intellij-idea" aria-hidden="true" class="header-anchor">#</a> 2.3 Setup of IntelliJ IDEA</h3> <p>NULS smart contract adopts IntelliJ IDEA as development tool</p> <h3 id="_2-4-setup-of-nuls-smart-contract-plug-ins"><a href="#_2-4-setup-of-nuls-smart-contract-plug-ins" aria-hidden="true" class="header-anchor">#</a> 2.4 Setup of NULS smart contract plug-ins</h3> <p><a href="https://nuls-usa-west.oss-us-west-1.aliyuncs.com/plugins/Docs%26plugin.zip" target="_blank" rel="noopener noreferrer">Click to download the plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>NULS smart contract plug-ins provide the following main functions:</p> <ul><li>Newly create NULS contract project</li> <li>Provide the unavailable Java properties, classes ad methods</li> <li>Compile, package and deploy contracts</li> <li>Display and call contract methods</li></ul> <h2 id="_3-nuls-smart-contract-specifications-and-syntax"><a href="#_3-nuls-smart-contract-specifications-and-syntax" aria-hidden="true" class="header-anchor">#</a> 3. NULS smart contract specifications and syntax</h2> <p>NULS smart contract syntax is a subset of Java syntax, with some restrictions</p> <h3 id="_3-1-nuls-smart-contract-specifications"><a href="#_3-1-nuls-smart-contract-specifications" aria-hidden="true" class="header-anchor">#</a> 3.1 NULS smart contract specifications</h3> <blockquote><p><strong><em>Main classes of contracts must implement contract interfaces. A smart contract can have a class implementing contract interface only; and other classes and interfaces provide functions for such contract.</em></strong></p></blockquote> <h3 id="_3-2-keywords"><a href="#_3-2-keywords" aria-hidden="true" class="header-anchor">#</a> 3.2 Keywords</h3> <p>Java key words are listed as follows and those not applicable for NULS smart contract will be marked</p> <p>Access control</p> <ul><li>public</li> <li>protected</li> <li>private</li></ul> <p>Key words and instantiated object of definition class, interface, abstract class, implementation interface and derivative class</p> <ul><li>class</li> <li>interface</li> <li>abstract</li> <li>implements</li> <li>extends</li> <li>new</li></ul> <p>Key words of package</p> <ul><li>import</li> <li>package</li></ul> <p>Key words of data type</p> <ul><li>byte</li> <li>char</li> <li>boolean</li> <li>short</li> <li>int</li> <li>float</li> <li>long</li> <li>double</li> <li>void</li> <li>null</li> <li>true</li> <li>false</li></ul> <p>Conditional loops (process control)</p> <ul><li>if</li> <li>else</li> <li>while</li> <li>for</li> <li>switch</li> <li>case</li> <li>default</li> <li>do</li> <li>break</li> <li>continue</li> <li>return</li> <li>instanceof</li></ul> <p>Error processing</p> <ul><li>catch</li> <li>try</li> <li>finally</li> <li>throw</li> <li>throws</li></ul> <p>Modification method, class, property and variables</p> <ul><li>static</li> <li>final</li> <li>super</li> <li>this</li> <li>native（not supported）</li> <li>strictfp（not supported）</li> <li>synchronized（not supported）</li> <li>transient（not supported）</li> <li>volatile（not supported）</li></ul> <p>other</p> <ul><li>enum（not supported）</li> <li>assert（not supported）</li></ul> <h3 id="_3-3-basic-syntax"><a href="#_3-3-basic-syntax" aria-hidden="true" class="header-anchor">#</a> 3.3 Basic syntax</h3> <p>The following syntax is the same with Java and simply listed here under, with specific details referred to the relevant documents of Java</p> <ul><li>Identifiers are consisted of character, underline, dollar sign or figure, beginning with character, underline or dollar sign</li> <li>Basic data type: byte short int long float double char boolean</li> <li>Reference data type: class, interface, array</li> <li>Arithmetic operators: + - * /%++ -</li> <li>Relational operator: &gt; &lt;&gt; = &lt;= ==! =</li> <li>Logical Operators: ! &amp;| ^ &amp;&amp; ||</li> <li>Bit operator: &amp;| ^~&gt;&gt; &lt;&lt; &gt;&gt;&gt;</li> <li>Assignment operator: =</li> <li>Extension assignment operators: + = - = * = / =</li> <li>String link operator: +</li> <li>Conditional operators: ? :</li> <li>Process control sentence (if, switch, for, while, do...while)</li></ul> <h3 id="_3-4-available-class"><a href="#_3-4-available-class" aria-hidden="true" class="header-anchor">#</a> 3.4 Available class</h3> <p>NULS smart contract can be developed with the following class</p> <ul><li>io.nuls.contract.sdk.Address</li> <li>io.nuls.contract.sdk.Block</li> <li>io.nuls.contract.sdk.BlockHeader</li> <li>io.nuls.contract.sdk.Contract</li> <li>io.nuls.contract.sdk.Event</li> <li>io.nuls.contract.sdk.Msg</li> <li>io.nuls.contract.sdk.Utils</li> <li>io.nuls.contract.sdk.annotation.View</li> <li>io.nuls.contract.sdk.annotation.Required</li> <li>io.nuls.contract.sdk.annotation.Payable</li> <li>java.lang.Boolean</li> <li>java.lang.Byte</li> <li>java.lang.Short</li> <li>java.lang.Character</li> <li>java.lang.Integer</li> <li>java.lang.Long</li> <li>java.lang.Float</li> <li>java.lang.Double</li> <li>java.lang.String</li> <li>java.lang.StringBuilder</li> <li>java.math.BigInteger</li> <li>java.math.BigDecimal</li> <li>java.util.Collection</li> <li>java.util.List</li> <li>java.util.ArrayList</li> <li>java.util.LinkedList</li> <li>java.util.Map</li> <li>java.util.HashMap</li> <li>java.util.LinkedHashMap</li> <li>java.util.Set</li> <li>java.util.HashSet</li></ul> <h3 id="_3-5-other-restrictions"><a href="#_3-5-other-restrictions" aria-hidden="true" class="header-anchor">#</a> 3.5 Other restrictions</h3> <ul><li>Contract class can have one construction method. No restriction for other classes</li> <li>The maximum gas consumption for executing a contract method once is 10 million, including the method of the <code>@View</code> type,  Make sure to optimize the contract code as much as possible.</li></ul> <h2 id="_4-nuls-smart-contract-example"><a href="#_4-nuls-smart-contract-example" aria-hidden="true" class="header-anchor">#</a> 4. Nuls smart contract example</h2> <p>a simple contract</p> <blockquote><p><strong><em>Main classes of contract must implement contract interface, and other classes and interfaces provide functions for this contract</em></strong></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code>
<span class="token keyword">package</span> contracts<span class="token punctuation">.</span>examples<span class="token punctuation">;</span>

<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Contract<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Payable<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Required<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>View<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleStorage</span> <span class="token keyword">implements</span> <span class="token class-name">Contract</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> String storedData<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> String <span class="token function">getStoredData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> storedData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Payable</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setStoredData</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> String storedData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>storedData <span class="token operator">=</span> storedData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>In one contract project, it requires to introduce a jar package “contract-sdk.jar” which provides the class to get block and transaction details
The project has several classes and interfaces</p> <p>When compiling, packaging and deploying the prepared contract onto the NULS chain, the virtual machine will implement the construction method of this contract to initialize it, and save the contract status onto the chain. The contract status is the member variables of contract class</p> <p>After the contract is deployed, all public methods of contract class can be called so as to read or modify the contract status</p> <p>Explanatory comments</p> <p>@View labels the method of @View. After it is called, the contract status will remain and it can be researched by such means</p> <p>@Payable labels the method of @Payable. Only when it is called, the amount can be transferred in</p> <p>@Required labels the parameter of @Required. When it is called, there must be transfer-in value</p> <p>Go to download NULS source code on github, and get some contract examples</p> <h2 id="_5-nuls-contract-sdk"><a href="#_5-nuls-contract-sdk" aria-hidden="true" class="header-anchor">#</a> 5. NULS Contract SDK</h2> <p>Contract SDK provides several classes to be convenient for contract development:</p> <h3 id="io-nuls-contract-sdk-address"><a href="#io-nuls-contract-sdk-address" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Address</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Address</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> String address<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Address</span><span class="token punctuation">(</span>String address<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">valid</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>address <span class="token operator">=</span> address<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Get the balance of the address (only the balance of contract address)
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">native</span> BigInteger <span class="token function">balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Transfer amount to the address from contract 
     *
     * @param value transfer amount (in Na)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span>BigInteger value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Contract method to call the address
     *
     * @param Method name
     * @param Method signature
     * @param Parameters       
     * @param value  Incidental currency (in Na)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span>String methodName<span class="token punctuation">,</span> String methodDesc<span class="token punctuation">,</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
     * Call the contract method of this address with a return value(String)
     *
     * @param Method name
     * @param Method signature
     * @param Parameters       
     * @param value  Incidental currency (in Na)
     * @return return value after calling the contract
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">native</span> String <span class="token function">callWithReturnValue</span><span class="token punctuation">(</span>String methodName<span class="token punctuation">,</span> String methodDesc<span class="token punctuation">,</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**
     * Verify the address 
     *
     * @param address
     * @see io.nuls.kernel.utils.AddressTool#validAddress(String)
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">valid</span><span class="token punctuation">(</span>String address<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span>Object o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> o<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        Address address1 <span class="token operator">=</span> <span class="token punctuation">(</span>Address<span class="token punctuation">)</span> o<span class="token punctuation">;</span>
        <span class="token keyword">return</span> address <span class="token operator">!=</span> null <span class="token operator">?</span> address<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>address1<span class="token punctuation">.</span>address<span class="token punctuation">)</span> <span class="token operator">:</span> address1<span class="token punctuation">.</span>address <span class="token operator">==</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> address <span class="token operator">!=</span> null <span class="token operator">?</span> address<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> address<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><h3 id="io-nuls-contract-sdk-block"><a href="#io-nuls-contract-sdk-block" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Block</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Block</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * Given block’s head
     *
     * @param blockNumber
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BlockHeader <span class="token function">getBlockHeader</span><span class="token punctuation">(</span><span class="token keyword">long</span> blockNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Current block’s head
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BlockHeader <span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**
     * Newest block’s head
     *
     * @return 
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BlockHeader <span class="token function">newestBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Given block’s hash
     *
     * @param blockNumber
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">blockhash</span><span class="token punctuation">(</span><span class="token keyword">long</span> blockNumber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getBlockHeader</span><span class="token punctuation">(</span>blockNumber<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 
     * CCurrent block’s miner address
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> Address <span class="token function">coinbase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPackingAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 
     * Current block’s No.
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">long</span> <span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 
     * Current block’s time stamp
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">long</span> <span class="token function">timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><h3 id="io-nuls-contract-sdk-blockheader"><a href="#io-nuls-contract-sdk-blockheader" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.BlockHeader</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BlockHeader</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> String hash<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> time<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> height<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> txCount<span class="token punctuation">;</span>
    <span class="token keyword">private</span> Address packingAddress<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String stateRoot<span class="token punctuation">;</span>

    <span class="token keyword">public</span> String <span class="token function">getHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> time<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> height<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getTxCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> txCount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> Address <span class="token function">getPackingAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> packingAddress<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">getStateRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> stateRoot<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span>Object o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> o<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> o<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        BlockHeader that <span class="token operator">=</span> <span class="token punctuation">(</span>BlockHeader<span class="token punctuation">)</span> o<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">!=</span> that<span class="token punctuation">.</span>time<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>height <span class="token operator">!=</span> that<span class="token punctuation">.</span>height<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>txCount <span class="token operator">!=</span> that<span class="token punctuation">.</span>txCount<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>hash <span class="token operator">!=</span> null <span class="token operator">?</span> <span class="token operator">!</span>hash<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>hash<span class="token punctuation">)</span> <span class="token operator">:</span> that<span class="token punctuation">.</span>hash <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>packingAddress <span class="token operator">!=</span> null <span class="token operator">?</span> <span class="token operator">!</span>packingAddress<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>packingAddress<span class="token punctuation">)</span> <span class="token operator">:</span> that<span class="token punctuation">.</span>packingAddress <span class="token operator">!=</span> null<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> stateRoot <span class="token operator">!=</span> null <span class="token operator">?</span> stateRoot<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>stateRoot<span class="token punctuation">)</span> <span class="token operator">:</span> that<span class="token punctuation">.</span>stateRoot <span class="token operator">==</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> hash <span class="token operator">!=</span> null <span class="token operator">?</span> hash<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time <span class="token operator">^</span> <span class="token punctuation">(</span>time <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>height <span class="token operator">^</span> <span class="token punctuation">(</span>height <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>txCount <span class="token operator">^</span> <span class="token punctuation">(</span>txCount <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span>packingAddress <span class="token operator">!=</span> null <span class="token operator">?</span> packingAddress<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span>stateRoot <span class="token operator">!=</span> null <span class="token operator">?</span> stateRoot<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;BlockHeader{&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;hash='&quot;</span> <span class="token operator">+</span> hash <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">&quot;, time=&quot;</span> <span class="token operator">+</span> time <span class="token operator">+</span>
                <span class="token string">&quot;, height=&quot;</span> <span class="token operator">+</span> height <span class="token operator">+</span>
                <span class="token string">&quot;, txCount=&quot;</span> <span class="token operator">+</span> txCount <span class="token operator">+</span>
                <span class="token string">&quot;, packingAddress=&quot;</span> <span class="token operator">+</span> packingAddress <span class="token operator">+</span>
                <span class="token string">&quot;, stateRoot='&quot;</span> <span class="token operator">+</span> stateRoot <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><h3 id="io-nuls-contract-sdk-contract"><a href="#io-nuls-contract-sdk-contract" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Contract</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 *  Contract interface, implemented by contract class
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Contract</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * Directly transfer to the contract, this method will be called, no action is done by default. If the contract address is to accept direct transfer, you can override this method and mark the `@Payable` annotation.
     */</span>
    <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">_payable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="io-nuls-contract-sdk-event"><a href="#io-nuls-contract-sdk-event" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Event</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
* Event interface, implemented by event class
*/</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Event</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="io-nuls-contract-sdk-msg"><a href="#io-nuls-contract-sdk-msg" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Msg</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Msg</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * Remaining gas
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">long</span> <span class="token function">gasleft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * sender of the contract
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> Address <span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * The number of Nuls transferred by the contract sender to the contract address, the unit is Na, 1Nuls = 1 billion Na
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BigInteger <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Gas price
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">long</span> <span class="token function">gasprice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Contract address
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> Address <span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h3 id="io-nuls-contract-sdk-utils"><a href="#io-nuls-contract-sdk-utils" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Utils</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Utils</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token function">Utils</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     *  Check conditions; if conditions are not met, it will roll back.
     *
     * @param expression
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> expression<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>expression<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">revert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Check conditions; if conditions are not met, it will roll back
     *
     * @param expression
     * @param errorMessage
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> expression<span class="token punctuation">,</span> String errorMessage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>expression<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">revert</span><span class="token punctuation">(</span>errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Terminate implementation and restore status
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">revert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">revert</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Terminate implementation and restore status
     *
     * @param errorMessage
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">revert</span><span class="token punctuation">(</span>String errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Send events
     *
     * @param event
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">emit</span><span class="token punctuation">(</span>Event event<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
     * @param seed a private seed
     * @return pseudo random number (0 ~ 1)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">float</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span><span class="token keyword">long</span> seed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> hash1 <span class="token operator">=</span> Block<span class="token punctuation">.</span><span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPackingAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> hash2 <span class="token operator">=</span> Msg<span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> hash3 <span class="token operator">=</span> Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null <span class="token operator">?</span> Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> hash4 <span class="token operator">=</span> Long<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>Block<span class="token punctuation">.</span><span class="token function">timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">long</span> hash <span class="token operator">=</span> seed <span class="token operator">^</span> hash1 <span class="token operator">^</span> hash2 <span class="token operator">^</span> hash3 <span class="token operator">^</span> hash4<span class="token punctuation">;</span>

        seed <span class="token operator">=</span> <span class="token punctuation">(</span>hash <span class="token operator">*</span> <span class="token number">0</span>x5DEECE66DL <span class="token operator">+</span> <span class="token number">0</span>xBL<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span>L <span class="token operator">&lt;&lt;</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>seed <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @return pseudo random number (0 ~ 1)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">float</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span><span class="token number">0</span>x5DEECE66DL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @param src source string
     * @return sha3-256 hash (utf-8 encode)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> String <span class="token function">sha3</span><span class="token punctuation">(</span>String src<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * @param bytes source byte array
     * @return sha3-256 hash
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> String <span class="token function">sha3</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br></div></div><h3 id="io-nuls-contract-sdk-annotation-payable"><a href="#io-nuls-contract-sdk-annotation-payable" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.annotation.Payable</h3> <p><code>@Payable labels the method of @Payable. Only when it is called, the amount can be transferred in</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span>ElementType<span class="token punctuation">.</span>METHOD<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">Payable</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="io-nuls-contract-sdk-annotation-required"><a href="#io-nuls-contract-sdk-annotation-required" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.annotation.Required</h3> <p><code>@Required labels the parameter of @Required. When it is called, there must be transfer-in value.</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span>ElementType<span class="token punctuation">.</span>PARAMETER<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">Required</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="io-nuls-contract-sdk-annotation-view"><a href="#io-nuls-contract-sdk-annotation-view" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.annotation.View</h3> <p><code>@Viewlabels the method of @View. After it is called, the contract status will remain and it can be researched by such means</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span>ElementType<span class="token punctuation">.</span>METHOD<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">View</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_6-main-rpc-interface-of-smart-contract"><a href="#_6-main-rpc-interface-of-smart-contract" aria-hidden="true" class="header-anchor">#</a> 6. Main RPC interface of smart contract</h2> <p>See parameter structure and simple examples hereafter. See details of other interfaces at [Swagger UI] (http://127.0.0.1:8001/docs#/)</p> <blockquote><p>The default port of test network’s “Swagger UI” is 8001, and that of official network is 6001</p></blockquote> <h3 id="_6-1-create-smart-contract"><a href="#_6-1-create-smart-contract" aria-hidden="true" class="header-anchor">#</a> 6.1 Create smart contract</h3> <ul><li>POST <code>/api/contract/create</code></li></ul> <table><thead><tr><th style="text-align:center">Parameter</th> <th style="text-align:center">Type</th> <th style="text-align:center">Description</th></tr></thead> <tbody><tr><td style="text-align:center">sender*</td> <td style="text-align:center">string</td> <td style="text-align:center">transaction creator</td></tr> <tr><td style="text-align:center">password*</td> <td style="text-align:center">string</td> <td style="text-align:center">password of transaction creator</td></tr> <tr><td style="text-align:center">gasLimit*</td> <td style="text-align:center">long</td> <td style="text-align:center">max. gas consumption</td></tr> <tr><td style="text-align:center">price*</td> <td style="text-align:center">long</td> <td style="text-align:center">unit price of implementation contract</td></tr> <tr><td style="text-align:center">contractCode*</td> <td style="text-align:center">string</td> <td style="text-align:center">smart contract code (byte code’s Hex coded string)</td></tr> <tr><td style="text-align:center">remark</td> <td style="text-align:center">string</td> <td style="text-align:center">remark</td></tr> <tr><td style="text-align:center">args</td> <td style="text-align:center">string[][]</td> <td style="text-align:center">Parameter list</td></tr></tbody></table> <ul><li>Example Value</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Nsdz8mKKFMehRDVRZFyXNuuenugUYM7M&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;gasLimit&quot;</span><span class="token operator">:</span> <span class="token number">4687</span><span class="token punctuation">,</span>
  <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contractCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;504b03041400080808003b5aed4c000000000000000000000000090004004d4554412d494e462ffeca00000300504b0708000000000200000000000000504b03041400080808003b5aed4c000000000000000000000000140000004d4554412d494e462f4d414e49464553542e4d46f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5722e4a4d2c494dd175aa040958e819c41b9a982868f8172526e7a42a38e71715e417259600d56bf272f1720100504b07089e7c76534400000045000000504b03040a00000800007559ed4c0000000000000000000000000d00000074657374636f6e74726163742f504b03041400080808008359ed4c0000000000000000000000001f00000074657374636f6e74726163742f54657374436f6e74726163742e636c6173737d535d53d350103d9796a684604b2cdf20c5cf365a421110f986225a2cf040c5d1b7b40d25d0264c9232e39bbfc2f147f8a03352189df107f8a31cf7b635744a310f7befeedd73f6dcdd9bdf7f7efc023083bd2e746052801ac4948824a6453cc58c8859cc75827f9f3f7de4de331e9f0fe2b9883e2c04b1c8714bdc2c0b581111c60237ab41acf1754ec0ba800d06bfa99575063973ac9d696a49338beabe6b1b66719121e07c28e7ac12434fca321d5733dd03ad54a1ec6041cf1b65ade430b0b48f44c80c425177776b5c9158bc1d9b3f6515e83494314c7db752cee97656cb956ab5adbc563ad06c83fb8da0df3d32887e24e3ea8e9bb74cd7d6f2ae9a2527d57088b28b6aee373476d37ed393e58bc5d3a429a791863c574c10d339d46dbad592611aee4a2de78041dcb72a765edf3278d5dee60293fc12120630c83074a30c868e6c56404ac2265e08d89210c34b01af24a4312e611baf25c491a1baeb6f93b3f36f2428784cd23947d63ad14d094318943082518681d6be6d548c5241b725ec609740d144b4cec210be4addcb1deb5cc89861a966a5e4a89e50a770a25e091d6c7bbee314a9535aa160eb0e752e4ad36b9bb75ecfa0b68ffeef9ccafc9b7f59738fd40da398365dbda8db848cb48bf3e958f5eb929033fec4f60ea9e5b1ed1b798662ed4ff84003dae9a96e161812b1ebcff0facb6c74781113f4aff481a11f3edad1d4f9bbe6b3a1d830ed3b282ef33179fe1802b4bf8371b2518aa8b4325a3b95ef605f6b29136403b5a082bb64a57a02eee13ead0c0f3c70a201f6c9be56e86413d4e7411fe2512b342c7f69814eb785c6bcaa330da878097f159d55045a8bcf3531881e43dc6358265e7e16228608844b745521cadd573422adc002512c3651853c2afa1d1a5456832aa95c4052e49e733045f69de3961296cf11fa89f0bb0bf42aefa9bb55c8f26d32554428eb9b576c9854032bf05367456a51989ad48f554c61ada978d22bfea4864cfc05504b070818c1191cd20200006f050000504b010214001400080808003b5aed4c0000000002000000000000000900040000000000000000000000000000004d4554412d494e462ffeca0000504b010214001400080808003b5aed4c9e7c7653440000004500000014000000000000000000000000003d0000004d4554412d494e462f4d414e49464553542e4d46504b01020a000a00000800007559ed4c0000000000000000000000000d00000000000000000000000000c300000074657374636f6e74726163742f504b010214001400080808008359ed4c18c1191cd20200006f0500001f00000000000000000000000000ee00000074657374636f6e74726163742f54657374436f6e74726163742e636c617373504b05060000000004000400050100000d0400000000&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;asd&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_6-2-estimate-the-gas-consumption-for-creating-smart-contract"><a href="#_6-2-estimate-the-gas-consumption-for-creating-smart-contract" aria-hidden="true" class="header-anchor">#</a> 6.2 Estimate the gas consumption for creating smart contract</h3> <ul><li>POST <code>/api/contract/imputedgas/create</code></li></ul> <table><thead><tr><th style="text-align:center">Parameter</th> <th style="text-align:center">Type</th> <th style="text-align:center">Description</th></tr></thead> <tbody><tr><td style="text-align:center">sender*</td> <td style="text-align:center">string</td> <td style="text-align:center">transaction creator</td></tr> <tr><td style="text-align:center">password*</td> <td style="text-align:center">string</td> <td style="text-align:center">password of transaction creator</td></tr> <tr><td style="text-align:center">price*</td> <td style="text-align:center">long</td> <td style="text-align:center">unit price of implementation contract</td></tr> <tr><td style="text-align:center">contractCode*</td> <td style="text-align:center">string</td> <td style="text-align:center">smart contract code (byte code’s Hex coded string)</td></tr> <tr><td style="text-align:center">args</td> <td style="text-align:center">string[][]</td> <td style="text-align:center">Parameter list</td></tr></tbody></table> <ul><li>Example Value</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Nsdz8mKKFMehRDVRZFyXNuuenugUYM7M&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contractCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;504b03041400080808003b5aed4c000000000000000000000000090004004d4554412d494e462ffeca00000300504b0708000000000200000000000000504b03041400080808003b5aed4c000000000000000000000000140000004d4554412d494e462f4d414e49464553542e4d46f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5722e4a4d2c494dd175aa040958e819c41b9a982868f8172526e7a42a38e71715e417259600d56bf272f1720100504b07089e7c76534400000045000000504b03040a00000800007559ed4c0000000000000000000000000d00000074657374636f6e74726163742f504b03041400080808008359ed4c0000000000000000000000001f00000074657374636f6e74726163742f54657374436f6e74726163742e636c6173737d535d53d350103d9796a684604b2cdf20c5cf365a421110f986225a2cf040c5d1b7b40d25d0264c9232e39bbfc2f147f8a03352189df107f8a31cf7b635744a310f7befeedd73f6dcdd9bdf7f7efc023083bd2e746052801ac4948824a6453cc58c8859cc75827f9f3f7de4de331e9f0fe2b9883e2c04b1c8714bdc2c0b581111c60237ab41acf1754ec0ba800d06bfa99575063973ac9d696a49338beabe6b1b66719121e07c28e7ac12434fca321d5733dd03ad54a1ec6041cf1b65ade430b0b48f44c80c425177776b5c9158bc1d9b3f6515e83494314c7db752cee97656cb956ab5adbc563ad06c83fb8da0df3d32887e24e3ea8e9bb74cd7d6f2ae9a2527d57088b28b6aee373476d37ed393e58bc5d3a429a791863c574c10d339d46dbad592611aee4a2de78041dcb72a765edf3278d5dee60293fc12120630c83074a30c868e6c56404ac2265e08d89210c34b01af24a4312e611baf25c491a1baeb6f93b3f36f2428784cd23947d63ad14d094318943082518681d6be6d548c5241b725ec609740d144b4cec210be4addcb1deb5cc89861a966a5e4a89e50a770a25e091d6c7bbee314a9535aa160eb0e752e4ad36b9bb75ecfa0b68ffeef9ccafc9b7f59738fd40da398365dbda8db848cb48bf3e958f5eb929033fec4f60ea9e5b1ed1b798662ed4ff84003dae9a96e161812b1ebcff0facb6c74781113f4aff481a11f3edad1d4f9bbe6b3a1d830ed3b282ef33179fe1802b4bf8371b2518aa8b4325a3b95ef605f6b29136403b5a082bb64a57a02eee13ead0c0f3c70a201f6c9be56e86413d4e7411fe2512b342c7f69814eb785c6bcaa330da878097f159d55045a8bcf3531881e43dc6358265e7e16228608844b745521cadd573422adc002512c3651853c2afa1d1a5456832aa95c4052e49e733045f69de3961296cf11fa89f0bb0bf42aefa9bb55c8f26d32554428eb9b576c9854032bf05367456a51989ad48f554c61ada978d22bfea4864cfc05504b070818c1191cd20200006f050000504b010214001400080808003b5aed4c0000000002000000000000000900040000000000000000000000000000004d4554412d494e462ffeca0000504b010214001400080808003b5aed4c9e7c7653440000004500000014000000000000000000000000003d0000004d4554412d494e462f4d414e49464553542e4d46504b01020a000a00000800007559ed4c0000000000000000000000000d00000000000000000000000000c300000074657374636f6e74726163742f504b010214001400080808008359ed4c18c1191cd20200006f0500001f00000000000000000000000000ee00000074657374636f6e74726163742f54657374436f6e74726163742e636c617373504b05060000000004000400050100000d0400000000&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_6-3-call-smart-contract"><a href="#_6-3-call-smart-contract" aria-hidden="true" class="header-anchor">#</a> 6.3 Call smart contract</h3> <ul><li>POST <code>/api/contract/call</code></li></ul> <table><thead><tr><th style="text-align:center">Parameter</th> <th style="text-align:center">Type</th> <th style="text-align:center">Description</th></tr></thead> <tbody><tr><td style="text-align:center">sender*</td> <td style="text-align:center">string</td> <td style="text-align:center">transaction creator</td></tr> <tr><td style="text-align:center">password*</td> <td style="text-align:center">string</td> <td style="text-align:center">password of transaction creator</td></tr> <tr><td style="text-align:center">contractAddress*</td> <td style="text-align:center">string</td> <td style="text-align:center">address of smart contract</td></tr> <tr><td style="text-align:center">gasLimit*</td> <td style="text-align:center">long</td> <td style="text-align:center">max. gas consumption</td></tr> <tr><td style="text-align:center">price*</td> <td style="text-align:center">long</td> <td style="text-align:center">unit price of implementation contract</td></tr> <tr><td style="text-align:center">value</td> <td style="text-align:center">long</td> <td style="text-align:center">amount transferred by transaction creator to contract address (Na - 100000000Na=1NULS)</td></tr> <tr><td style="text-align:center">methodName*</td> <td style="text-align:center">string</td> <td style="text-align:center">method name</td></tr> <tr><td style="text-align:center">methodDesc</td> <td style="text-align:center">string</td> <td style="text-align:center">method signature which may be not transferred if the method name is not repeated</td></tr> <tr><td style="text-align:center">remark</td> <td style="text-align:center">string</td> <td style="text-align:center">remark</td></tr> <tr><td style="text-align:center">args</td> <td style="text-align:center">string[][]</td> <td style="text-align:center">Parameter list</td></tr></tbody></table> <ul><li>Example Value</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Nsdz8mKKFMehRDVRZFyXNuuenugUYM7M&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contractAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NseBvPEzerLi3p5Me8Rbm7SeHThVGv1U&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;gasLimit&quot;</span><span class="token operator">:</span> <span class="token number">8000</span><span class="token punctuation">,</span>
  <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;methodName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;methodDesc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;qwe&quot;</span>
  <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_6-4-estimate-the-gas-consumption-for-calling-smart-contract-see-swagger-ui"><a href="#_6-4-estimate-the-gas-consumption-for-calling-smart-contract-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.4 Estimate the gas consumption for calling smart contract (see <code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/imputedgas/call</code></li></ul> <h3 id="_6-5-estimate-the-price-for-calling-smart-contract-see-swagger-ui"><a href="#_6-5-estimate-the-price-for-calling-smart-contract-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.5 Estimate the price for calling smart contract (see <code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/imputedprice</code></li></ul> <h3 id="_6-6-terminate-smart-contract-see-swagger-ui"><a href="#_6-6-terminate-smart-contract-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.6 Terminate smart contract (see <code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/delete</code></li></ul> <h3 id="_6-7-call-the-smart-contract-function-which-is-not-linked-to-blockchain-see-swagger-ui"><a href="#_6-7-call-the-smart-contract-function-which-is-not-linked-to-blockchain-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.7 Call the smart contract function which is not linked to blockchain (see <code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/view</code></li></ul> <h3 id="_6-8-get-the-implementation-results-of-smart-contract-see-swagger-ui"><a href="#_6-8-get-the-implementation-results-of-smart-contract-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.8 Get the implementation results of smart contract (see <code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/result/{hash}</code></li></ul> <h3 id="_6-9-get-the-basic-information-of-smart-contract-see-swagger-ui"><a href="#_6-9-get-the-basic-information-of-smart-contract-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.9 Get the basic information of smart contract (see <code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/info/{address}</code></li></ul> <h3 id="_6-10-verify-if-it-is-contract-address-see-swagger-ui"><a href="#_6-10-verify-if-it-is-contract-address-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.10 Verify if it is contract address (see <code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/{address}</code></li></ul> <h3 id="_6-11-get-the-nuls-balance-of-smart-contract-address-see-swagger-ui"><a href="#_6-11-get-the-nuls-balance-of-smart-contract-address-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.11 Get the NULS balance of smart contract address (see <code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/balance/{address}</code></li></ul> <h3 id="_6-12-get-the-transaction-details-of-smart-contract-see-swagger-ui"><a href="#_6-12-get-the-transaction-details-of-smart-contract-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.12 Get the transaction details of smart contract (see <code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/tx/{hash}</code></li></ul> <h3 id="_6-13-get-the-transaction-list-of-smart-contract-see-swagger-ui"><a href="#_6-13-get-the-transaction-list-of-smart-contract-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.13 Get the transaction list of smart contract (see <code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/tx/list/{address}</code></li></ul> <h3 id="_6-14-inquire-contract-utxo-as-per-address-and-limit-see-swagger-ui"><a href="#_6-14-inquire-contract-utxo-as-per-address-and-limit-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.14 Inquire contract UTXO as per address and limit (see <code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/limit/{address}/{limit}</code></li></ul> <h3 id="_6-15-inquire-contract-utxo-as-per-address-and-amount-see-swagger-ui"><a href="#_6-15-inquire-contract-utxo-as-per-address-and-amount-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.15 Inquire contract UTXO as per address and amount (see <code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/amount/{address}/{amount}</code></li></ul> <h3 id="_6-16-transfer-amount-to-smart-contract-see-swagger-ui"><a href="#_6-16-transfer-amount-to-smart-contract-see-swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.16 Transfer amount to smart contract (see <code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/transfer</code></li></ul> <h2 id="_7-example"><a href="#_7-example" aria-hidden="true" class="header-anchor">#</a> 7. Example</h2> <h3 id="_7-1-voting-smart-contract-code-segments-are-as-follows"><a href="#_7-1-voting-smart-contract-code-segments-are-as-follows" aria-hidden="true" class="header-anchor">#</a> 7.1 Voting smart contract code <code>segments</code> are as follows</h3> <blockquote><p>Full code: <code>https://github.com/nuls-io/nuls-vote</code></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">;</span>

<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Address<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Contract<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Utils<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Payable<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>View<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>func<span class="token punctuation">.</span>BaseVote<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>func<span class="token punctuation">.</span>VoteInterface<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>model<span class="token punctuation">.</span>VoteConfig<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>model<span class="token punctuation">.</span>VoteEntity<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigInteger<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Map<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VoteContract</span> <span class="token keyword">implements</span> <span class="token class-name">Contract</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> VoteInterface baseVote<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">VoteContract</span><span class="token punctuation">(</span><span class="token keyword">long</span> minRecognizance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        baseVote <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BaseVote</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>minRecognizance<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Payable</span>
    <span class="token keyword">public</span> VoteEntity <span class="token function">create</span><span class="token punctuation">(</span>String title<span class="token punctuation">,</span> String desc<span class="token punctuation">,</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> items<span class="token punctuation">,</span> <span class="token keyword">long</span> startTime<span class="token punctuation">,</span> <span class="token keyword">long</span> endTime<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isMultipleSelect<span class="token punctuation">,</span> <span class="token keyword">int</span> maxSelectCount<span class="token punctuation">,</span> <span class="token keyword">boolean</span> voteCanModify<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        VoteEntity voteEntity <span class="token operator">=</span> baseVote<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> desc<span class="token punctuation">,</span> items<span class="token punctuation">)</span><span class="token punctuation">;</span>

        VoteConfig config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VoteConfig</span><span class="token punctuation">(</span>startTime<span class="token punctuation">,</span> endTime<span class="token punctuation">,</span> isMultipleSelect<span class="token punctuation">,</span> maxSelectCount<span class="token punctuation">,</span> voteCanModify<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> success <span class="token operator">=</span> baseVote<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>voteEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>

        Utils<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span>success<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> voteEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">vote</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">,</span> <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> itemIds<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">vote</span><span class="token punctuation">(</span>voteId<span class="token punctuation">,</span> itemIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">redemption</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">redemption</span><span class="token punctuation">(</span>voteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canVote</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">canVote</span><span class="token punctuation">(</span>voteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> VoteEntity <span class="token function">queryVote</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">queryVote</span><span class="token punctuation">(</span>voteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> Map<span class="token operator">&lt;</span>Address<span class="token punctuation">,</span> List<span class="token generics function"><span class="token punctuation">&lt;</span>Long<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> <span class="token function">queryVoteResult</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">queryVoteResult</span><span class="token punctuation">(</span>voteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">queryAddressHasVote</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">,</span> Address address<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">queryAddressHasVote</span><span class="token punctuation">(</span>voteId<span class="token punctuation">,</span> address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><p>If the methods of smart contract include the parameter of  <code>array type</code>, please use the following method to transfer parameters</p> <blockquote><p>Refer to the <code>create</code> method in the aforesaid voting contract code</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;sender&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;NsdtydTVWskMc7GkZzbsq2FoChqKFwMf&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;password&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;contractAddress&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;NseLt14NacjTDhXaTXUdrk6VF7aEwtW4&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;gasLimit&quot;</span><span class="token punctuation">:</span> <span class="token number">200000</span><span class="token punctuation">,</span>
  <span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span> <span class="token number">10000000000</span><span class="token punctuation">,</span>
  <span class="token string">&quot;methodName&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;create&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;methodDesc&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;remark&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;args&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
     <span class="token string">&quot;Test voting 1&quot;</span><span class="token punctuation">,</span>
     <span class="token string">&quot;Voting contract 1&quot;</span><span class="token punctuation">,</span>
     <span class="token punctuation">[</span>
       <span class="token string">&quot;Option 1&quot;</span><span class="token punctuation">,</span>
       <span class="token string">&quot;Option 2&quot;</span><span class="token punctuation">,</span>
       <span class="token string">&quot;Option 3&quot;</span>
     <span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token number">1536044066056</span><span class="token punctuation">,</span> <span class="token number">1536184066056</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token boolean">false</span>
   <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_7-2-standard-token-smart-contract-code-segments"><a href="#_7-2-standard-token-smart-contract-code-segments" aria-hidden="true" class="header-anchor">#</a> 7.2 Standard Token Smart contract code <code>segments</code></h3> <blockquote><p>Full code: <code>https://github.com/nuls-io/nuls-nrc20</code></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>token<span class="token punctuation">;</span>

<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Address<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Contract<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Msg<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Required<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>View<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigInteger<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>HashMap<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Map<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Utils<span class="token punctuation">.</span>emit<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Utils<span class="token punctuation">.</span>require<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleToken</span> <span class="token keyword">implements</span> <span class="token class-name">Contract</span><span class="token punctuation">,</span> Token <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> String name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> String symbol<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> decimals<span class="token punctuation">;</span>
    <span class="token keyword">private</span> BigInteger totalSupply <span class="token operator">=</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">;</span>

    <span class="token keyword">private</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span> balances <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> Map<span class="token operator">&lt;</span>Address<span class="token punctuation">,</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> allowed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>Address<span class="token punctuation">,</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> String <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> String <span class="token function">symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> symbol<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">decimals</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> decimals<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> BigInteger <span class="token function">totalSupply</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> totalSupply<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">SimpleToken</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> String name<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> String symbol<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger initialAmount<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> <span class="token keyword">int</span> decimals<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>symbol <span class="token operator">=</span> symbol<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>decimals <span class="token operator">=</span> decimals<span class="token punctuation">;</span>
        totalSupply <span class="token operator">=</span> initialAmount<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>TEN<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>decimals<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        balances<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> totalSupply<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TransferEvent</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span> Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> totalSupply<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> BigInteger <span class="token function">allowance</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address owner<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> Address spender<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span> ownerAllowed <span class="token operator">=</span> allowed<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>owner<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ownerAllowed <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        BigInteger value <span class="token operator">=</span> ownerAllowed<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>spender<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            value <span class="token operator">=</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">transferFrom</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address from<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> Address to<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">subtractAllowed</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">subtractBalance</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addBalance</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TransferEvent</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> BigInteger <span class="token function">balanceOf</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address owner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>owner <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
        BigInteger balance <span class="token operator">=</span> balances<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>owner<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>balance <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            balance <span class="token operator">=</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> balance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address to<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">subtractBalance</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addBalance</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TransferEvent</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">approve</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address spender<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setAllowed</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ApprovalEvent</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">increaseApproval</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address spender<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger addedValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">addAllowed</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> addedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ApprovalEvent</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> <span class="token function">allowance</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">decreaseApproval</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address spender<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger subtractedValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">check</span><span class="token punctuation">(</span>subtractedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        BigInteger oldValue <span class="token operator">=</span> <span class="token function">allowance</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>subtractedValue<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>oldValue<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setAllowed</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">subtractAllowed</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> subtractedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ApprovalEvent</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> <span class="token function">allowance</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addAllowed</span><span class="token punctuation">(</span>Address address1<span class="token punctuation">,</span> Address address2<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BigInteger allowance <span class="token operator">=</span> <span class="token function">allowance</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>allowance<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setAllowed</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address2<span class="token punctuation">,</span> allowance<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">subtractAllowed</span><span class="token punctuation">(</span>Address address1<span class="token punctuation">,</span> Address address2<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BigInteger allowance <span class="token operator">=</span> <span class="token function">allowance</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>allowance<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token string">&quot;Insufficient approved token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setAllowed</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address2<span class="token punctuation">,</span> allowance<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">setAllowed</span><span class="token punctuation">(</span>Address address1<span class="token punctuation">,</span> Address address2<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span> address1Allowed <span class="token operator">=</span> allowed<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>address1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>address1Allowed <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            address1Allowed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            allowed<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address1Allowed<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        address1Allowed<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>address2<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addBalance</span><span class="token punctuation">(</span>Address address<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BigInteger balance <span class="token operator">=</span> <span class="token function">balanceOf</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">&quot;The value must be greater than or equal to 0.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
        balances<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> balance<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">subtractBalance</span><span class="token punctuation">(</span>Address address<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BigInteger balance <span class="token operator">=</span> <span class="token function">balanceOf</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>balance<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token string">&quot;Insufficient balance of token.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        balances<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> balance<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>value <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>BigInteger value1<span class="token punctuation">,</span> BigInteger value2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span>value1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>BigInteger value<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>value <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>BigInteger value1<span class="token punctuation">,</span> BigInteger value2<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span>value1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>



<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br></div></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/nuls-io/devsite/edit/dev/docs/smartContract/developerManual.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">1/9/2019, 4:46:46 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/smartContract/startSmartContract.html" class="prev">
          Quick Start
        </a></span> <span class="next"><a href="/smartContract/GUIForSmartContract.html">
          User Document of Wallet Smart Contract
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.9c98b51a.js" defer></script><script src="/assets/js/58.431966d2.js" defer></script>
  </body>
</html>
