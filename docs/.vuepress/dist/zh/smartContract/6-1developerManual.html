<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>[快速入门] NULS智能合约开发者手册 | NULS</title>
    <meta name="description" content="Vue 驱动的静态网站生成器">
    
    
    <link rel="preload" href="/assets/css/0.styles.87801eb7.css" as="style"><link rel="preload" href="/assets/js/app.f0dccc53.js" as="script"><link rel="preload" href="/assets/js/50.bc8b6fb3.js" as="script"><link rel="prefetch" href="/assets/js/10.adcd50a2.js"><link rel="prefetch" href="/assets/js/11.23d51952.js"><link rel="prefetch" href="/assets/js/12.af362357.js"><link rel="prefetch" href="/assets/js/13.dbd5dd27.js"><link rel="prefetch" href="/assets/js/14.99b27887.js"><link rel="prefetch" href="/assets/js/15.9ef74b8e.js"><link rel="prefetch" href="/assets/js/16.c4b77db3.js"><link rel="prefetch" href="/assets/js/17.0609f9c5.js"><link rel="prefetch" href="/assets/js/18.02adc72d.js"><link rel="prefetch" href="/assets/js/19.9330d6b9.js"><link rel="prefetch" href="/assets/js/20.3a4659f3.js"><link rel="prefetch" href="/assets/js/21.cbd71e03.js"><link rel="prefetch" href="/assets/js/22.67a0ccc5.js"><link rel="prefetch" href="/assets/js/23.7ccf57f3.js"><link rel="prefetch" href="/assets/js/24.7e9a6cf8.js"><link rel="prefetch" href="/assets/js/25.194a7f12.js"><link rel="prefetch" href="/assets/js/26.56055a2c.js"><link rel="prefetch" href="/assets/js/27.cfbac0d6.js"><link rel="prefetch" href="/assets/js/28.d743ddb4.js"><link rel="prefetch" href="/assets/js/29.bb1a211b.js"><link rel="prefetch" href="/assets/js/3.8bb86b43.js"><link rel="prefetch" href="/assets/js/30.0ddd2538.js"><link rel="prefetch" href="/assets/js/31.5084c548.js"><link rel="prefetch" href="/assets/js/32.ce771734.js"><link rel="prefetch" href="/assets/js/33.477d1b6a.js"><link rel="prefetch" href="/assets/js/34.db009c85.js"><link rel="prefetch" href="/assets/js/35.b54e24fc.js"><link rel="prefetch" href="/assets/js/36.4411e28a.js"><link rel="prefetch" href="/assets/js/37.57da6b86.js"><link rel="prefetch" href="/assets/js/38.ce577132.js"><link rel="prefetch" href="/assets/js/39.fc4fde25.js"><link rel="prefetch" href="/assets/js/4.bf89d940.js"><link rel="prefetch" href="/assets/js/40.398295c2.js"><link rel="prefetch" href="/assets/js/41.e31c613d.js"><link rel="prefetch" href="/assets/js/42.d22c3192.js"><link rel="prefetch" href="/assets/js/43.835f542d.js"><link rel="prefetch" href="/assets/js/44.6d93e433.js"><link rel="prefetch" href="/assets/js/45.3cae8b83.js"><link rel="prefetch" href="/assets/js/46.3b90a35c.js"><link rel="prefetch" href="/assets/js/47.efc0aebb.js"><link rel="prefetch" href="/assets/js/48.b7296e35.js"><link rel="prefetch" href="/assets/js/49.a8875200.js"><link rel="prefetch" href="/assets/js/5.1d69716f.js"><link rel="prefetch" href="/assets/js/51.6ba74c7c.js"><link rel="prefetch" href="/assets/js/52.8ec9fddd.js"><link rel="prefetch" href="/assets/js/53.09b96d7b.js"><link rel="prefetch" href="/assets/js/54.997f79f4.js"><link rel="prefetch" href="/assets/js/55.035feb42.js"><link rel="prefetch" href="/assets/js/56.f01ed60e.js"><link rel="prefetch" href="/assets/js/57.116a8ebd.js"><link rel="prefetch" href="/assets/js/58.4c3fde67.js"><link rel="prefetch" href="/assets/js/59.a8838de6.js"><link rel="prefetch" href="/assets/js/6.e25ed6e1.js"><link rel="prefetch" href="/assets/js/60.fc0dbd0d.js"><link rel="prefetch" href="/assets/js/7.8c7722b5.js"><link rel="prefetch" href="/assets/js/8.0c2c887e.js"><link rel="prefetch" href="/assets/js/9.33c355d5.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.f6d6e3fd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.87801eb7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zh/" class="home-link router-link-active"><!----> <span class="site-name">NULS</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/smartContract/6-1developerManual.html" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/zh/smartContract/6-1developerManual.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li></ul></div></div> <a href="https://github.com/nuls-io/devsite" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/smartContract/6-1developerManual.html" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/zh/smartContract/6-1developerManual.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li></ul></div></div> <a href="https://github.com/nuls-io/devsite" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>总览</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>如何做贡献</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>如何启动NULS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>搭建私链</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>NULS底层</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>智能合约</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/zh/smartContract/6-8startSmartContract.html" class="sidebar-link">[快速入门]从0开始NULS智能合约</a></li><li><a href="/zh/smartContract/6-1developerManual.html" class="active sidebar-link">[快速入门] NULS智能合约开发者手册</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_1-简介" class="sidebar-link">1. 简介</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_2-开发环境" class="sidebar-link">2. 开发环境</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_2-1-安装nuls钱包" class="sidebar-link">2.1 安装NULS钱包</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_2-2-安装jdk-8" class="sidebar-link">2.2 安装JDK 8</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_2-3-安装intellij-idea" class="sidebar-link">2.3 安装IntelliJ IDEA</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_2-4-安装nuls智能合约插件" class="sidebar-link">2.4 安装NULS智能合约插件</a></li></ul></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_3-nuls智能合约规范与语法" class="sidebar-link">3. NULS智能合约规范与语法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_3-1-nuls智能合约规范" class="sidebar-link">3.1 NULS智能合约规范</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_3-2-关键字" class="sidebar-link">3.2 关键字</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_3-3-基本语法" class="sidebar-link">3.3 基本语法</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_3-4-支持的类" class="sidebar-link">3.4 支持的类</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_3-5-其他限制" class="sidebar-link">3.5 其他限制</a></li></ul></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_4-nuls智能合约简单示例" class="sidebar-link">4. NULS智能合约简单示例</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_5-nuls-contract-sdk" class="sidebar-link">5. NULS Contract SDK</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#io-nuls-contract-sdk-address" class="sidebar-link">io.nuls.contract.sdk.Address</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#io-nuls-contract-sdk-block" class="sidebar-link">io.nuls.contract.sdk.Block</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#io-nuls-contract-sdk-blockheader" class="sidebar-link">io.nuls.contract.sdk.BlockHeader</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#io-nuls-contract-sdk-contract" class="sidebar-link">io.nuls.contract.sdk.Contract</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#io-nuls-contract-sdk-event" class="sidebar-link">io.nuls.contract.sdk.Event</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#io-nuls-contract-sdk-msg" class="sidebar-link">io.nuls.contract.sdk.Msg</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#io-nuls-contract-sdk-utils" class="sidebar-link">io.nuls.contract.sdk.Utils</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#io-nuls-contract-sdk-annotation-payable" class="sidebar-link">io.nuls.contract.sdk.annotation.Payable</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#io-nuls-contract-sdk-annotation-required" class="sidebar-link">io.nuls.contract.sdk.annotation.Required</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#io-nuls-contract-sdk-annotation-view" class="sidebar-link">io.nuls.contract.sdk.annotation.View</a></li></ul></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-智能合约主要的rpc接口" class="sidebar-link">6. 智能合约主要的RPC接口</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-1-创建智能合约" class="sidebar-link">6.1 创建智能合约</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-2-估算创建智能合约的gas消耗" class="sidebar-link">6.2 估算创建智能合约的Gas消耗</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-3-调用智能合约" class="sidebar-link">6.3 调用智能合约</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-4-估算调用智能合约的gas消耗-参见swagger-ui" class="sidebar-link">6.4 估算调用智能合约的Gas消耗(参见Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-5-估算智能合约的price-参见swagger-ui" class="sidebar-link">6.5 估算智能合约的price(参见Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-6-终止智能合约-参见swagger-ui" class="sidebar-link">6.6 终止智能合约(参见Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-7-调用不上链的智能合约函数-参见swagger-ui" class="sidebar-link">6.7 调用不上链的智能合约函数(参见Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-8-获取智能合约执行结果-参见swagger-ui" class="sidebar-link">6.8 获取智能合约执行结果(参见Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-9-获取智能合约基本信息-参见swagger-ui" class="sidebar-link">6.9 获取智能合约基本信息(参见Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-10-验证是否为合约地址-参见swagger-ui" class="sidebar-link">6.10 验证是否为合约地址(参见Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-11-获取智能合约地址的nuls余额-参见swagger-ui" class="sidebar-link">6.11 获取智能合约地址的NULS余额(参见Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-12-获取智能合约交易详情-参见swagger-ui" class="sidebar-link">6.12 获取智能合约交易详情(参见Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-13-获取智能合约的交易列表-参见swagger-ui" class="sidebar-link">6.13 获取智能合约的交易列表(参见Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-14-根据address和limit查询合约utxo-参见swagger-ui" class="sidebar-link">6.14 根据address和limit查询合约UTXO(参见Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-15-根据address和amount查询合约utxo-参见swagger-ui" class="sidebar-link">6.15 根据address和amount查询合约UTXO(参见Swagger UI)</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_6-16-向智能合约转账-参见swagger-ui" class="sidebar-link">6.16 向智能合约转账(参见Swagger UI)</a></li></ul></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_7-示例" class="sidebar-link">7. 示例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_7-1-投票智能合约代码片段-如下" class="sidebar-link">7.1 投票智能合约代码片段, 如下</a></li><li class="sidebar-sub-header"><a href="/zh/smartContract/6-1developerManual.html#_7-2-standard-token-智能合约代码片段" class="sidebar-link">7.2 Standard Token 智能合约代码片段</a></li></ul></li></ul></li><li><a href="/zh/smartContract/6-2GUIForSmartContract.html" class="sidebar-link">[快速入门] 智能合约操作手册</a></li><li><a href="/zh/smartContract/6-3ideaPlugin.html" class="sidebar-link">[快速入门] 智能合约插件</a></li><li><a href="/zh/smartContract/6-4NRC-20TokenStandard.html" class="sidebar-link">[合约标准] NRC-20</a></li><li><a href="/zh/smartContract/6-5smartContractDemo.html" class="sidebar-link">智能合约示例</a></li><li><a href="/zh/smartContract/6-6communityVote.html" class="sidebar-link">社区投票指南</a></li><li><a href="/zh/smartContract/6-7smartContractFee.html" class="sidebar-link">智能合约手续费</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>开发者工具</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>NULS 导航</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="快速入门-nuls智能合约开发者手册"><a href="#快速入门-nuls智能合约开发者手册" aria-hidden="true" class="header-anchor">#</a> [快速入门] NULS智能合约开发者手册</h1> <h2 id="_1-简介"><a href="#_1-简介" aria-hidden="true" class="header-anchor">#</a> 1. 简介</h2> <p>NULS智能合约使用Java进行开发，合约运行在NULS虚拟机中。合约开发不能使用所有的Java特性，在第3节列出具体限制。</p> <h2 id="_2-开发环境"><a href="#_2-开发环境" aria-hidden="true" class="header-anchor">#</a> 2. 开发环境</h2> <h3 id="_2-1-安装nuls钱包"><a href="#_2-1-安装nuls钱包" aria-hidden="true" class="header-anchor">#</a> 2.1 安装NULS钱包</h3> <h3 id="_2-2-安装jdk-8"><a href="#_2-2-安装jdk-8" aria-hidden="true" class="header-anchor">#</a> 2.2 安装JDK 8</h3> <h3 id="_2-3-安装intellij-idea"><a href="#_2-3-安装intellij-idea" aria-hidden="true" class="header-anchor">#</a> 2.3 安装IntelliJ IDEA</h3> <p>Nuls智能合约使用的开发工具为IntelliJ IDEA。</p> <h3 id="_2-4-安装nuls智能合约插件"><a href="#_2-4-安装nuls智能合约插件" aria-hidden="true" class="header-anchor">#</a> 2.4 安装NULS智能合约插件</h3> <p><a href="https://nuls-usa-west.oss-us-west-1.aliyuncs.com/plugins/Docs%26plugin.zip" target="_blank" rel="noopener noreferrer">点击下载插件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>NULS智能合约插件提供的主要功能：</p> <ul><li>新建NULS合约工程</li> <li>提示不支持的Java特性、Java类、Java方法</li> <li>编译、打包、部署合约</li> <li>展示、调用合约方法。</li></ul> <h2 id="_3-nuls智能合约规范与语法"><a href="#_3-nuls智能合约规范与语法" aria-hidden="true" class="header-anchor">#</a> 3. NULS智能合约规范与语法</h2> <p>Nuls智能合约语法是Java语法的一个子集，在Java语法上做了一些限制。</p> <h3 id="_3-1-nuls智能合约规范"><a href="#_3-1-nuls智能合约规范" aria-hidden="true" class="header-anchor">#</a> 3.1 NULS智能合约规范</h3> <blockquote><p><strong><em>合约主类必须实现Contract接口，一个智能合约只能有一个类实现Contract接口，其他类和接口都是为这个合约提供功能的。</em></strong></p></blockquote> <h3 id="_3-2-关键字"><a href="#_3-2-关键字" aria-hidden="true" class="header-anchor">#</a> 3.2 关键字</h3> <p>下面列出Java关键字，其中将标注NULS智能合约不支持的关键字</p> <p>访问控制</p> <ul><li>public</li> <li>protected</li> <li>private</li></ul> <p>定义类、接口、抽象类和实现接口、继承类的关键字、实例化对象</p> <ul><li>class</li> <li>interface</li> <li>abstract</li> <li>implements</li> <li>extends</li> <li>new</li></ul> <p>包的关键字</p> <ul><li>import</li> <li>package</li></ul> <p>数据类型的关键字</p> <ul><li>byte</li> <li>char</li> <li>boolean</li> <li>short</li> <li>int</li> <li>float</li> <li>long</li> <li>double</li> <li>void</li> <li>null</li> <li>true</li> <li>false</li></ul> <p>条件循环（流程控制）</p> <ul><li>if</li> <li>else</li> <li>while</li> <li>for</li> <li>switch</li> <li>case</li> <li>default</li> <li>do</li> <li>break</li> <li>continue</li> <li>return</li> <li>instanceof</li></ul> <p>错误处理</p> <ul><li>catch</li> <li>try</li> <li>finally</li> <li>throw</li> <li>throws</li></ul> <p>修饰方法、类、属性和变量</p> <ul><li>static</li> <li>final</li> <li>super</li> <li>this</li> <li>native（不支持）</li> <li>strictfp（不支持）</li> <li>synchronized（不支持）</li> <li>transient（不支持）</li> <li>volatile（不支持）</li></ul> <p>其他</p> <ul><li>enum（不支持）</li> <li>assert（不支持）</li></ul> <h3 id="_3-3-基本语法"><a href="#_3-3-基本语法" aria-hidden="true" class="header-anchor">#</a> 3.3 基本语法</h3> <p>下面的语法与Java相同，只是简单列出，具体可参考Java相关文档</p> <ul><li>标识符：由字符、下划线、美元符或数字组成，以字符、下划线、美元符开头</li> <li>基本数据类型：byte short int long float double char boolean</li> <li>引用数据类型：类、接口、数组</li> <li>算术运算符：+        -        *        /        %        ++        --</li> <li>关系运算符：&gt;        &lt;        &gt;=        &lt;=        ==        !=</li> <li>逻辑运算符：!        &amp;        |        ^        &amp;&amp;        ||</li> <li>位运算符：&amp;        |        ^        ~        &gt;&gt;        &lt;&lt;        &gt;&gt;&gt;</li> <li>赋值运算符：=</li> <li>拓展赋值运算符：+        =        -=        *=        /=</li> <li>字符串链接运算符：+</li> <li>三目条件运算符          ?        :</li> <li>流程控制语句（if,switch,for,while,do...while）</li></ul> <h3 id="_3-4-支持的类"><a href="#_3-4-支持的类" aria-hidden="true" class="header-anchor">#</a> 3.4 支持的类</h3> <p>Nuls智能合约只能使用下面的类进行开发</p> <ul><li>io.nuls.contract.sdk.Address</li> <li>io.nuls.contract.sdk.Block</li> <li>io.nuls.contract.sdk.BlockHeader</li> <li>io.nuls.contract.sdk.Contract</li> <li>io.nuls.contract.sdk.Event</li> <li>io.nuls.contract.sdk.Msg</li> <li>io.nuls.contract.sdk.Utils</li> <li>io.nuls.contract.sdk.annotation.View</li> <li>io.nuls.contract.sdk.annotation.Required</li> <li>io.nuls.contract.sdk.annotation.Payable</li> <li>java.lang.Boolean</li> <li>java.lang.Byte</li> <li>java.lang.Short</li> <li>java.lang.Character</li> <li>java.lang.Integer</li> <li>java.lang.Long</li> <li>java.lang.Float</li> <li>java.lang.Double</li> <li>java.lang.String</li> <li>java.lang.StringBuilder</li> <li>java.math.BigInteger</li> <li>java.math.BigDecimal</li> <li>java.util.Collection</li> <li>java.util.List</li> <li>java.util.ArrayList</li> <li>java.util.LinkedList</li> <li>java.util.Map</li> <li>java.util.HashMap</li> <li>java.util.LinkedHashMap</li> <li>java.util.Set</li> <li>java.util.HashSet</li></ul> <h3 id="_3-5-其他限制"><a href="#_3-5-其他限制" aria-hidden="true" class="header-anchor">#</a> 3.5 其他限制</h3> <ul><li>合约类只能有一个构造方法，其他类不限制</li> <li>执行一次合约方法最大的Gas消耗是1000万，包括<code>@View</code>类型的方法调用，请保证尽可能的优化合约代码</li></ul> <h2 id="_4-nuls智能合约简单示例"><a href="#_4-nuls智能合约简单示例" aria-hidden="true" class="header-anchor">#</a> 4. NULS智能合约简单示例</h2> <p>一个简单的合约</p> <blockquote><p><strong><em>合约主类必须实现Contract接口，其他类和接口都是为这个合约提供功能的。</em></strong></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> contracts<span class="token punctuation">.</span>examples<span class="token punctuation">;</span>

<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Contract<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Payable<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Required<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>View<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleStorage</span> <span class="token keyword">implements</span> <span class="token class-name">Contract</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> String storedData<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> String <span class="token function">getStoredData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> storedData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Payable</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setStoredData</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> String storedData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>storedData <span class="token operator">=</span> storedData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>在一个合约项目中，只需要引入jar包：contract-sdk.jar，这个包提供了获取区块信息和交易信息的类。
项目中可以有多个类和接口。</p> <p>合约写好后，编译打包，部署到NULS链上时候，虚拟机会执行合约的构造方法初始化这个合约，并把这个合约状态保存在链上，合约状态是合约类的所有成员变量。
合约部署好以后，合约类的所有public方法都是能调用的，通过调用这些方法读取或修改合约状态。</p> <p>注解说明</p> <p>@View 标记@View的方法，调用后合约状态不会改变，可以通过这种方法查询合约状态。</p> <p>@Payable 标记@Payable的方法，才能在调用时候传入金额</p> <p>@Required 标记@Required的参数，调用时候必须传入值</p> <p>去github下载NULS源码，里面有一些合约示例。</p> <h2 id="_5-nuls-contract-sdk"><a href="#_5-nuls-contract-sdk" aria-hidden="true" class="header-anchor">#</a> 5. NULS Contract SDK</h2> <p>合约SDK提供了几个类，方便合约开发：</p> <h3 id="io-nuls-contract-sdk-address"><a href="#io-nuls-contract-sdk-address" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Address</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Address</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> String address<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Address</span><span class="token punctuation">(</span>String address<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">valid</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>address <span class="token operator">=</span> address<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取该地址的余额（只能获取合约地址余额）
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">native</span> BigInteger <span class="token function">balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 合约向该地址转账
     *
     * @param value 转账金额（多少Na）
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span>BigInteger value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 调用该地址的合约方法
     *
     * @param methodName 方法名
     * @param methodDesc 方法签名
     * @param args       参数
     * @param value      附带的货币量（多少Na）
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span>String methodName<span class="token punctuation">,</span> String methodDesc<span class="token punctuation">,</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
     * 调用该地址的合约方法并带有返回值(String)
     *
     * @param methodName 方法名
     * @param methodDesc 方法签名
     * @param args       参数
     * @param value      附带的货币量（多少Na）
     * @return 调用合约后的返回值
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">native</span> String <span class="token function">callWithReturnValue</span><span class="token punctuation">(</span>String methodName<span class="token punctuation">,</span> String methodDesc<span class="token punctuation">,</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**
     * 验证地址
     *
     * @param address
     * @see io.nuls.kernel.utils.AddressTool#validAddress(String)
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">valid</span><span class="token punctuation">(</span>String address<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span>Object o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> o<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        Address address1 <span class="token operator">=</span> <span class="token punctuation">(</span>Address<span class="token punctuation">)</span> o<span class="token punctuation">;</span>
        <span class="token keyword">return</span> address <span class="token operator">!=</span> null <span class="token operator">?</span> address<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>address1<span class="token punctuation">.</span>address<span class="token punctuation">)</span> <span class="token operator">:</span> address1<span class="token punctuation">.</span>address <span class="token operator">==</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> address <span class="token operator">!=</span> null <span class="token operator">?</span> address<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> address<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><h3 id="io-nuls-contract-sdk-block"><a href="#io-nuls-contract-sdk-block" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Block</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Block</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 给定块的区块头
     *
     * @param blockNumber
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BlockHeader <span class="token function">getBlockHeader</span><span class="token punctuation">(</span><span class="token keyword">long</span> blockNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 当前块的区块头
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BlockHeader <span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**
     * 最新块的区块头
     *
     * @return 最新块的区块头
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BlockHeader <span class="token function">newestBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 给定块的哈希值
     * hash of the given block
     *
     * @param blockNumber
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">blockhash</span><span class="token punctuation">(</span><span class="token keyword">long</span> blockNumber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getBlockHeader</span><span class="token punctuation">(</span>blockNumber<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 当前块矿工地址
     * current block miner’s address
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> Address <span class="token function">coinbase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPackingAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 当前块编号
     * current block number
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">long</span> <span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 当前块时间戳
     * current block timestamp
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">long</span> <span class="token function">timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div><h3 id="io-nuls-contract-sdk-blockheader"><a href="#io-nuls-contract-sdk-blockheader" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.BlockHeader</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BlockHeader</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> String hash<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> time<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> height<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> txCount<span class="token punctuation">;</span>
    <span class="token keyword">private</span> Address packingAddress<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String stateRoot<span class="token punctuation">;</span>

    <span class="token keyword">public</span> String <span class="token function">getHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> time<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> height<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getTxCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> txCount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> Address <span class="token function">getPackingAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> packingAddress<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">getStateRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> stateRoot<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span>Object o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> o<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> o<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        BlockHeader that <span class="token operator">=</span> <span class="token punctuation">(</span>BlockHeader<span class="token punctuation">)</span> o<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">!=</span> that<span class="token punctuation">.</span>time<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>height <span class="token operator">!=</span> that<span class="token punctuation">.</span>height<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>txCount <span class="token operator">!=</span> that<span class="token punctuation">.</span>txCount<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>hash <span class="token operator">!=</span> null <span class="token operator">?</span> <span class="token operator">!</span>hash<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>hash<span class="token punctuation">)</span> <span class="token operator">:</span> that<span class="token punctuation">.</span>hash <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>packingAddress <span class="token operator">!=</span> null <span class="token operator">?</span> <span class="token operator">!</span>packingAddress<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>packingAddress<span class="token punctuation">)</span> <span class="token operator">:</span> that<span class="token punctuation">.</span>packingAddress <span class="token operator">!=</span> null<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> stateRoot <span class="token operator">!=</span> null <span class="token operator">?</span> stateRoot<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>stateRoot<span class="token punctuation">)</span> <span class="token operator">:</span> that<span class="token punctuation">.</span>stateRoot <span class="token operator">==</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> hash <span class="token operator">!=</span> null <span class="token operator">?</span> hash<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time <span class="token operator">^</span> <span class="token punctuation">(</span>time <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>height <span class="token operator">^</span> <span class="token punctuation">(</span>height <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>txCount <span class="token operator">^</span> <span class="token punctuation">(</span>txCount <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span>packingAddress <span class="token operator">!=</span> null <span class="token operator">?</span> packingAddress<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span>stateRoot <span class="token operator">!=</span> null <span class="token operator">?</span> stateRoot<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;BlockHeader{&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;hash='&quot;</span> <span class="token operator">+</span> hash <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">&quot;, time=&quot;</span> <span class="token operator">+</span> time <span class="token operator">+</span>
                <span class="token string">&quot;, height=&quot;</span> <span class="token operator">+</span> height <span class="token operator">+</span>
                <span class="token string">&quot;, txCount=&quot;</span> <span class="token operator">+</span> txCount <span class="token operator">+</span>
                <span class="token string">&quot;, packingAddress=&quot;</span> <span class="token operator">+</span> packingAddress <span class="token operator">+</span>
                <span class="token string">&quot;, stateRoot='&quot;</span> <span class="token operator">+</span> stateRoot <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><h3 id="io-nuls-contract-sdk-contract"><a href="#io-nuls-contract-sdk-contract" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Contract</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * 合约接口，合约类实现这个接口
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Contract</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 直接向合约转账，会调用这个方法，默认不做任何操作，如果合约地址要接受直接转账，可以重载这个方法，并且标记`@Payable`注解。
     */</span>
    <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">_payable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="io-nuls-contract-sdk-event"><a href="#io-nuls-contract-sdk-event" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Event</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
* 事件接口，事件类实现这个接口
*/</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Event</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="io-nuls-contract-sdk-msg"><a href="#io-nuls-contract-sdk-msg" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Msg</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Msg</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 剩余Gas
     * remaining gas
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">long</span> <span class="token function">gasleft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 合约发送者地址
     * sender of the contract
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> Address <span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 合约发送者转入合约地址的Nuls数量，单位是Na，1Nuls=1亿Na
     * The number of Nuls transferred by the contract sender to the contract address, the unit is Na, 1Nuls = 1 billion Na
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BigInteger <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Gas价格
     * gas price
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">long</span> <span class="token function">gasprice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 合约地址
     * contract address
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> Address <span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h3 id="io-nuls-contract-sdk-utils"><a href="#io-nuls-contract-sdk-utils" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Utils</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Utils</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token function">Utils</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 检查条件，如果条件不满足则回滚
     *
     * @param expression
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> expression<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>expression<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">revert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 检查条件，如果条件不满足则回滚
     *
     * @param expression
     * @param errorMessage
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> expression<span class="token punctuation">,</span> String errorMessage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>expression<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">revert</span><span class="token punctuation">(</span>errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 终止执行并还原改变的状态
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">revert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">revert</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 终止执行并还原改变的状态
     *
     * @param errorMessage
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">revert</span><span class="token punctuation">(</span>String errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 发送事件
     *
     * @param event
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">emit</span><span class="token punctuation">(</span>Event event<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
     * Returns a power of two size for the given target capacity.
     *
     * @param cap capacity
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">powerSizeFor</span><span class="token punctuation">(</span><span class="token keyword">int</span> cap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> cap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
        n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">;</span>
        n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">;</span>
        n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
        n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;=</span> MAXIMUM_CAPACITY<span class="token punctuation">)</span> <span class="token operator">?</span> MAXIMUM_CAPACITY <span class="token operator">:</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @param seed a private seed
     * @return pseudo random number (0 ~ 1073741823)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span><span class="token keyword">int</span> seed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span>seed<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @param seed  a private seed
     * @return pseudo random number (0 ~ 1073741823)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span>String seed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span> seed<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @param seed a private seed
     * @param initialCapacity initial capacity, it will be assigned a power of two size for the given target capacity.
     * @return pseudo random number (0 ~ (powerSizeFor(initialCapacity) - 1))
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span><span class="token keyword">int</span> seed<span class="token punctuation">,</span> Integer initialCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span>seed<span class="token punctuation">,</span> null<span class="token punctuation">,</span> initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @param seed a private seed
     * @param initialCapacity initial capacity, it will be assigned a power of two size for the given target capacity.
     * @return pseudo random number (0 ~ (powerSizeFor(initialCapacity) - 1))
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span>String seed<span class="token punctuation">,</span> Integer initialCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span> seed<span class="token punctuation">,</span> initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @param seed a private seed
     * @param strSeed a private seed
     * @param initialCapacity initial capacity, it will be assigned a power of two size for the given target capacity.
     * @return pseudo random number (0 ~ (powerSizeFor(initialCapacity) - 1))
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span>Integer seed<span class="token punctuation">,</span> String strSeed<span class="token punctuation">,</span> Integer initialCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BlockHeader blockHeader <span class="token operator">=</span> Block<span class="token punctuation">.</span><span class="token function">newestBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>initialCapacity <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            initialCapacity <span class="token operator">=</span> <span class="token function">powerSizeFor</span><span class="token punctuation">(</span>initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            initialCapacity <span class="token operator">=</span> MAXIMUM_CAPACITY<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">long</span> time <span class="token operator">=</span> blockHeader<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> txCount <span class="token operator">=</span> blockHeader<span class="token punctuation">.</span><span class="token function">getTxCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String contractAddress <span class="token operator">=</span> Msg<span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> contractAddress <span class="token operator">!=</span> null <span class="token operator">?</span> contractAddress<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> strSeed <span class="token operator">!=</span> null <span class="token operator">?</span> strSeed<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>seed <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>seed <span class="token operator">^</span> <span class="token punctuation">(</span>seed <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time <span class="token operator">^</span> <span class="token punctuation">(</span>time <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>txCount <span class="token operator">^</span> <span class="token punctuation">(</span>txCount <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> result <span class="token operator">^</span> <span class="token punctuation">(</span>result <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> result<span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br></div></div><h3 id="io-nuls-contract-sdk-annotation-payable"><a href="#io-nuls-contract-sdk-annotation-payable" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.annotation.Payable</h3> <p><code>@Payable 标记@Payable的方法，才能在调用时候转入金额</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span>ElementType<span class="token punctuation">.</span>METHOD<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">Payable</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="io-nuls-contract-sdk-annotation-required"><a href="#io-nuls-contract-sdk-annotation-required" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.annotation.Required</h3> <p><code>@Required 标记@Required的参数，调用时候必须传入值</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span>ElementType<span class="token punctuation">.</span>PARAMETER<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">Required</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="io-nuls-contract-sdk-annotation-view"><a href="#io-nuls-contract-sdk-annotation-view" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.annotation.View</h3> <p><code>@View 标记@View的方法，调用后合约状态不会改变，可以通过这种方法查询合约状态。</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span>ElementType<span class="token punctuation">.</span>METHOD<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">View</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_6-智能合约主要的rpc接口"><a href="#_6-智能合约主要的rpc接口" aria-hidden="true" class="header-anchor">#</a> 6. 智能合约主要的RPC接口</h2> <p>这里列举几个接口的参数结构及简单实例，其他接口请参见<a href="http://127.0.0.1:8001/docs#/" target="_blank" rel="noopener noreferrer">Swagger UI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>测试网的<code>Swagger UI</code>的端口默认是8001，正式网的端口默认是6001</p></blockquote> <h3 id="_6-1-创建智能合约"><a href="#_6-1-创建智能合约" aria-hidden="true" class="header-anchor">#</a> 6.1 创建智能合约</h3> <ul><li>POST <code>/api/contract/create</code></li></ul> <table><thead><tr><th style="text-align:center">参数</th> <th style="text-align:center">类型</th> <th style="text-align:center">说明</th></tr></thead> <tbody><tr><td style="text-align:center">sender*</td> <td style="text-align:center">string</td> <td style="text-align:center">交易创建者</td></tr> <tr><td style="text-align:center">password*</td> <td style="text-align:center">string</td> <td style="text-align:center">交易创建者账户密码</td></tr> <tr><td style="text-align:center">gasLimit*</td> <td style="text-align:center">long</td> <td style="text-align:center">最大gas消耗</td></tr> <tr><td style="text-align:center">price*</td> <td style="text-align:center">long</td> <td style="text-align:center">执行合约单价</td></tr> <tr><td style="text-align:center">contractCode*</td> <td style="text-align:center">string</td> <td style="text-align:center">智能合约代码(字节码的Hex编码字符串)</td></tr> <tr><td style="text-align:center">remark</td> <td style="text-align:center">string</td> <td style="text-align:center">备注</td></tr> <tr><td style="text-align:center">args</td> <td style="text-align:center">string[][]</td> <td style="text-align:center">参数列表</td></tr></tbody></table> <ul><li>Example Value</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Nsdz8mKKFMehRDVRZFyXNuuenugUYM7M&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;gasLimit&quot;</span><span class="token operator">:</span> <span class="token number">4687</span><span class="token punctuation">,</span>
  <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contractCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;504b03041400080808003b5aed4c000000000000000000000000090004004d4554412d494e462ffeca00000300504b0708000000000200000000000000504b03041400080808003b5aed4c000000000000000000000000140000004d4554412d494e462f4d414e49464553542e4d46f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5722e4a4d2c494dd175aa040958e819c41b9a982868f8172526e7a42a38e71715e417259600d56bf272f1720100504b07089e7c76534400000045000000504b03040a00000800007559ed4c0000000000000000000000000d00000074657374636f6e74726163742f504b03041400080808008359ed4c0000000000000000000000001f00000074657374636f6e74726163742f54657374436f6e74726163742e636c6173737d535d53d350103d9796a684604b2cdf20c5cf365a421110f986225a2cf040c5d1b7b40d25d0264c9232e39bbfc2f147f8a03352189df107f8a31cf7b635744a310f7befeedd73f6dcdd9bdf7f7efc023083bd2e746052801ac4948824a6453cc58c8859cc75827f9f3f7de4de331e9f0fe2b9883e2c04b1c8714bdc2c0b581111c60237ab41acf1754ec0ba800d06bfa99575063973ac9d696a49338beabe6b1b66719121e07c28e7ac12434fca321d5733dd03ad54a1ec6041cf1b65ade430b0b48f44c80c425177776b5c9158bc1d9b3f6515e83494314c7db752cee97656cb956ab5adbc563ad06c83fb8da0df3d32887e24e3ea8e9bb74cd7d6f2ae9a2527d57088b28b6aee373476d37ed393e58bc5d3a429a791863c574c10d339d46dbad592611aee4a2de78041dcb72a765edf3278d5dee60293fc12120630c83074a30c868e6c56404ac2265e08d89210c34b01af24a4312e611baf25c491a1baeb6f93b3f36f2428784cd23947d63ad14d094318943082518681d6be6d548c5241b725ec609740d144b4cec210be4addcb1deb5cc89861a966a5e4a89e50a770a25e091d6c7bbee314a9535aa160eb0e752e4ad36b9bb75ecfa0b68ffeef9ccafc9b7f59738fd40da398365dbda8db848cb48bf3e958f5eb929033fec4f60ea9e5b1ed1b798662ed4ff84003dae9a96e161812b1ebcff0facb6c74781113f4aff481a11f3edad1d4f9bbe6b3a1d830ed3b282ef33179fe1802b4bf8371b2518aa8b4325a3b95ef605f6b29136403b5a082bb64a57a02eee13ead0c0f3c70a201f6c9be56e86413d4e7411fe2512b342c7f69814eb785c6bcaa330da878097f159d55045a8bcf3531881e43dc6358265e7e16228608844b745521cadd573422adc002512c3651853c2afa1d1a5456832aa95c4052e49e733045f69de3961296cf11fa89f0bb0bf42aefa9bb55c8f26d32554428eb9b576c9854032bf05367456a51989ad48f554c61ada978d22bfea4864cfc05504b070818c1191cd20200006f050000504b010214001400080808003b5aed4c0000000002000000000000000900040000000000000000000000000000004d4554412d494e462ffeca0000504b010214001400080808003b5aed4c9e7c7653440000004500000014000000000000000000000000003d0000004d4554412d494e462f4d414e49464553542e4d46504b01020a000a00000800007559ed4c0000000000000000000000000d00000000000000000000000000c300000074657374636f6e74726163742f504b010214001400080808008359ed4c18c1191cd20200006f0500001f00000000000000000000000000ee00000074657374636f6e74726163742f54657374436f6e74726163742e636c617373504b05060000000004000400050100000d0400000000&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;asd&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_6-2-估算创建智能合约的gas消耗"><a href="#_6-2-估算创建智能合约的gas消耗" aria-hidden="true" class="header-anchor">#</a> 6.2 估算创建智能合约的Gas消耗</h3> <ul><li>POST <code>/api/contract/imputedgas/create</code></li></ul> <table><thead><tr><th style="text-align:center">参数</th> <th style="text-align:center">类型</th> <th style="text-align:center">说明</th></tr></thead> <tbody><tr><td style="text-align:center">sender*</td> <td style="text-align:center">string</td> <td style="text-align:center">交易创建者</td></tr> <tr><td style="text-align:center">password*</td> <td style="text-align:center">string</td> <td style="text-align:center">交易创建者账户密码</td></tr> <tr><td style="text-align:center">price*</td> <td style="text-align:center">long</td> <td style="text-align:center">执行合约单价</td></tr> <tr><td style="text-align:center">contractCode*</td> <td style="text-align:center">string</td> <td style="text-align:center">智能合约代码(字节码的Hex编码字符串)</td></tr> <tr><td style="text-align:center">args</td> <td style="text-align:center">string[][]</td> <td style="text-align:center">参数列表</td></tr></tbody></table> <ul><li>Example Value</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Nsdz8mKKFMehRDVRZFyXNuuenugUYM7M&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contractCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;504b03041400080808003b5aed4c000000000000000000000000090004004d4554412d494e462ffeca00000300504b0708000000000200000000000000504b03041400080808003b5aed4c000000000000000000000000140000004d4554412d494e462f4d414e49464553542e4d46f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5722e4a4d2c494dd175aa040958e819c41b9a982868f8172526e7a42a38e71715e417259600d56bf272f1720100504b07089e7c76534400000045000000504b03040a00000800007559ed4c0000000000000000000000000d00000074657374636f6e74726163742f504b03041400080808008359ed4c0000000000000000000000001f00000074657374636f6e74726163742f54657374436f6e74726163742e636c6173737d535d53d350103d9796a684604b2cdf20c5cf365a421110f986225a2cf040c5d1b7b40d25d0264c9232e39bbfc2f147f8a03352189df107f8a31cf7b635744a310f7befeedd73f6dcdd9bdf7f7efc023083bd2e746052801ac4948824a6453cc58c8859cc75827f9f3f7de4de331e9f0fe2b9883e2c04b1c8714bdc2c0b581111c60237ab41acf1754ec0ba800d06bfa99575063973ac9d696a49338beabe6b1b66719121e07c28e7ac12434fca321d5733dd03ad54a1ec6041cf1b65ade430b0b48f44c80c425177776b5c9158bc1d9b3f6515e83494314c7db752cee97656cb956ab5adbc563ad06c83fb8da0df3d32887e24e3ea8e9bb74cd7d6f2ae9a2527d57088b28b6aee373476d37ed393e58bc5d3a429a791863c574c10d339d46dbad592611aee4a2de78041dcb72a765edf3278d5dee60293fc12120630c83074a30c868e6c56404ac2265e08d89210c34b01af24a4312e611baf25c491a1baeb6f93b3f36f2428784cd23947d63ad14d094318943082518681d6be6d548c5241b725ec609740d144b4cec210be4addcb1deb5cc89861a966a5e4a89e50a770a25e091d6c7bbee314a9535aa160eb0e752e4ad36b9bb75ecfa0b68ffeef9ccafc9b7f59738fd40da398365dbda8db848cb48bf3e958f5eb929033fec4f60ea9e5b1ed1b798662ed4ff84003dae9a96e161812b1ebcff0facb6c74781113f4aff481a11f3edad1d4f9bbe6b3a1d830ed3b282ef33179fe1802b4bf8371b2518aa8b4325a3b95ef605f6b29136403b5a082bb64a57a02eee13ead0c0f3c70a201f6c9be56e86413d4e7411fe2512b342c7f69814eb785c6bcaa330da878097f159d55045a8bcf3531881e43dc6358265e7e16228608844b745521cadd573422adc002512c3651853c2afa1d1a5456832aa95c4052e49e733045f69de3961296cf11fa89f0bb0bf42aefa9bb55c8f26d32554428eb9b576c9854032bf05367456a51989ad48f554c61ada978d22bfea4864cfc05504b070818c1191cd20200006f050000504b010214001400080808003b5aed4c0000000002000000000000000900040000000000000000000000000000004d4554412d494e462ffeca0000504b010214001400080808003b5aed4c9e7c7653440000004500000014000000000000000000000000003d0000004d4554412d494e462f4d414e49464553542e4d46504b01020a000a00000800007559ed4c0000000000000000000000000d00000000000000000000000000c300000074657374636f6e74726163742f504b010214001400080808008359ed4c18c1191cd20200006f0500001f00000000000000000000000000ee00000074657374636f6e74726163742f54657374436f6e74726163742e636c617373504b05060000000004000400050100000d0400000000&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_6-3-调用智能合约"><a href="#_6-3-调用智能合约" aria-hidden="true" class="header-anchor">#</a> 6.3 调用智能合约</h3> <ul><li>POST <code>/api/contract/call</code></li></ul> <table><thead><tr><th style="text-align:center">参数</th> <th style="text-align:center">类型</th> <th style="text-align:center">说明</th></tr></thead> <tbody><tr><td style="text-align:center">sender*</td> <td style="text-align:center">string</td> <td style="text-align:center">交易创建者</td></tr> <tr><td style="text-align:center">password*</td> <td style="text-align:center">string</td> <td style="text-align:center">交易创建者账户密码</td></tr> <tr><td style="text-align:center">contractAddress*</td> <td style="text-align:center">string</td> <td style="text-align:center">智能合约地址</td></tr> <tr><td style="text-align:center">gasLimit*</td> <td style="text-align:center">long</td> <td style="text-align:center">最大Gas消耗</td></tr> <tr><td style="text-align:center">price*</td> <td style="text-align:center">long</td> <td style="text-align:center">执行合约单价</td></tr> <tr><td style="text-align:center">value</td> <td style="text-align:center">long</td> <td style="text-align:center">交易创建者向合约地址转账的金额(Na - 100000000Na=1NULS)</td></tr> <tr><td style="text-align:center">methodName*</td> <td style="text-align:center">string</td> <td style="text-align:center">方法名</td></tr> <tr><td style="text-align:center">methodDesc</td> <td style="text-align:center">string</td> <td style="text-align:center">方法签名，如果方法名不重复，可以不传</td></tr> <tr><td style="text-align:center">remark</td> <td style="text-align:center">string</td> <td style="text-align:center">备注</td></tr> <tr><td style="text-align:center">args</td> <td style="text-align:center">string[][]</td> <td style="text-align:center">参数列表</td></tr></tbody></table> <ul><li>Example Value</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Nsdz8mKKFMehRDVRZFyXNuuenugUYM7M&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contractAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NseBvPEzerLi3p5Me8Rbm7SeHThVGv1U&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;gasLimit&quot;</span><span class="token operator">:</span> <span class="token number">8000</span><span class="token punctuation">,</span>
  <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;methodName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;methodDesc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;qwe&quot;</span>
  <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_6-4-估算调用智能合约的gas消耗-参见swagger-ui"><a href="#_6-4-估算调用智能合约的gas消耗-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.4 估算调用智能合约的Gas消耗(参见<code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/imputedgas/call</code></li></ul> <h3 id="_6-5-估算智能合约的price-参见swagger-ui"><a href="#_6-5-估算智能合约的price-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.5 估算智能合约的price(参见<code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/imputedprice</code></li></ul> <h3 id="_6-6-终止智能合约-参见swagger-ui"><a href="#_6-6-终止智能合约-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.6 终止智能合约(参见<code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/delete</code></li></ul> <h3 id="_6-7-调用不上链的智能合约函数-参见swagger-ui"><a href="#_6-7-调用不上链的智能合约函数-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.7 调用不上链的智能合约函数(参见<code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/view</code></li></ul> <h3 id="_6-8-获取智能合约执行结果-参见swagger-ui"><a href="#_6-8-获取智能合约执行结果-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.8 获取智能合约执行结果(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/result/{hash}</code></li></ul> <h3 id="_6-9-获取智能合约基本信息-参见swagger-ui"><a href="#_6-9-获取智能合约基本信息-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.9 获取智能合约基本信息(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/info/{address}</code></li></ul> <h3 id="_6-10-验证是否为合约地址-参见swagger-ui"><a href="#_6-10-验证是否为合约地址-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.10 验证是否为合约地址(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/{address}</code></li></ul> <h3 id="_6-11-获取智能合约地址的nuls余额-参见swagger-ui"><a href="#_6-11-获取智能合约地址的nuls余额-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.11 获取智能合约地址的NULS余额(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/balance/{address}</code></li></ul> <h3 id="_6-12-获取智能合约交易详情-参见swagger-ui"><a href="#_6-12-获取智能合约交易详情-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.12 获取智能合约交易详情(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/tx/{hash}</code></li></ul> <h3 id="_6-13-获取智能合约的交易列表-参见swagger-ui"><a href="#_6-13-获取智能合约的交易列表-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.13 获取智能合约的交易列表(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/tx/list/{address}</code></li></ul> <h3 id="_6-14-根据address和limit查询合约utxo-参见swagger-ui"><a href="#_6-14-根据address和limit查询合约utxo-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.14 根据address和limit查询合约UTXO(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/limit/{address}/{limit}</code></li></ul> <h3 id="_6-15-根据address和amount查询合约utxo-参见swagger-ui"><a href="#_6-15-根据address和amount查询合约utxo-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.15 根据address和amount查询合约UTXO(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/amount/{address}/{amount}</code></li></ul> <h3 id="_6-16-向智能合约转账-参见swagger-ui"><a href="#_6-16-向智能合约转账-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.16 向智能合约转账(参见<code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/transfer</code></li></ul> <h2 id="_7-示例"><a href="#_7-示例" aria-hidden="true" class="header-anchor">#</a> 7. 示例</h2> <h3 id="_7-1-投票智能合约代码片段-如下"><a href="#_7-1-投票智能合约代码片段-如下" aria-hidden="true" class="header-anchor">#</a> 7.1 投票智能合约代码<code>片段</code>, 如下</h3> <blockquote><p>完整代码: <code>https://github.com/nuls-io/nuls-vote</code></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">;</span>

<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Address<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Contract<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Utils<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Payable<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>View<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>func<span class="token punctuation">.</span>BaseVote<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>func<span class="token punctuation">.</span>VoteInterface<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>model<span class="token punctuation">.</span>VoteConfig<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>model<span class="token punctuation">.</span>VoteEntity<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigInteger<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Map<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VoteContract</span> <span class="token keyword">implements</span> <span class="token class-name">Contract</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> VoteInterface baseVote<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">VoteContract</span><span class="token punctuation">(</span><span class="token keyword">long</span> minRecognizance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        baseVote <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BaseVote</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>minRecognizance<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Payable</span>
    <span class="token keyword">public</span> VoteEntity <span class="token function">create</span><span class="token punctuation">(</span>String title<span class="token punctuation">,</span> String desc<span class="token punctuation">,</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> items<span class="token punctuation">,</span> <span class="token keyword">long</span> startTime<span class="token punctuation">,</span> <span class="token keyword">long</span> endTime<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isMultipleSelect<span class="token punctuation">,</span> <span class="token keyword">int</span> maxSelectCount<span class="token punctuation">,</span> <span class="token keyword">boolean</span> voteCanModify<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        VoteEntity voteEntity <span class="token operator">=</span> baseVote<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> desc<span class="token punctuation">,</span> items<span class="token punctuation">)</span><span class="token punctuation">;</span>

        VoteConfig config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VoteConfig</span><span class="token punctuation">(</span>startTime<span class="token punctuation">,</span> endTime<span class="token punctuation">,</span> isMultipleSelect<span class="token punctuation">,</span> maxSelectCount<span class="token punctuation">,</span> voteCanModify<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> success <span class="token operator">=</span> baseVote<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>voteEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>

        Utils<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span>success<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> voteEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">vote</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">,</span> <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> itemIds<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">vote</span><span class="token punctuation">(</span>voteId<span class="token punctuation">,</span> itemIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">redemption</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">redemption</span><span class="token punctuation">(</span>voteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canVote</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">canVote</span><span class="token punctuation">(</span>voteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> VoteEntity <span class="token function">queryVote</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">queryVote</span><span class="token punctuation">(</span>voteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> Map<span class="token operator">&lt;</span>Address<span class="token punctuation">,</span> List<span class="token generics function"><span class="token punctuation">&lt;</span>Long<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> <span class="token function">queryVoteResult</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">queryVoteResult</span><span class="token punctuation">(</span>voteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">queryAddressHasVote</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">,</span> Address address<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">queryAddressHasVote</span><span class="token punctuation">(</span>voteId<span class="token punctuation">,</span> address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><p>智能合约的方法中如果有<code>数组类型</code>的参数，请使用如下方式传递参数</p> <blockquote><p>参考以上投票合约代码中的<code>create</code>方法</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;sender&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;NsdtydTVWskMc7GkZzbsq2FoChqKFwMf&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;password&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;contractAddress&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;NseLt14NacjTDhXaTXUdrk6VF7aEwtW4&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;gasLimit&quot;</span><span class="token punctuation">:</span> <span class="token number">200000</span><span class="token punctuation">,</span>
  <span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span> <span class="token number">10000000000</span><span class="token punctuation">,</span>
  <span class="token string">&quot;methodName&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;create&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;methodDesc&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;remark&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;args&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;测试投票1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;第一个投票合约&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;第一个选项&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;第二个选项&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;第三个选项&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">1536044066056</span><span class="token punctuation">,</span> <span class="token number">1536184066056</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token boolean">false</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_7-2-standard-token-智能合约代码片段"><a href="#_7-2-standard-token-智能合约代码片段" aria-hidden="true" class="header-anchor">#</a> 7.2 Standard Token 智能合约代码<code>片段</code></h3> <blockquote><p>完整代码: <code>https://github.com/nuls-io/nuls-nrc20</code></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>token<span class="token punctuation">;</span>

<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Address<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Contract<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Msg<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Required<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>View<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigInteger<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>HashMap<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Map<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Utils<span class="token punctuation">.</span>emit<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Utils<span class="token punctuation">.</span>require<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleToken</span> <span class="token keyword">implements</span> <span class="token class-name">Contract</span><span class="token punctuation">,</span> Token <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> String name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> String symbol<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> decimals<span class="token punctuation">;</span>
    <span class="token keyword">private</span> BigInteger totalSupply <span class="token operator">=</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">;</span>

    <span class="token keyword">private</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span> balances <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> Map<span class="token operator">&lt;</span>Address<span class="token punctuation">,</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> allowed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>Address<span class="token punctuation">,</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> String <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> String <span class="token function">symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> symbol<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">decimals</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> decimals<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> BigInteger <span class="token function">totalSupply</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> totalSupply<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">SimpleToken</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> String name<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> String symbol<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger initialAmount<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> <span class="token keyword">int</span> decimals<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>symbol <span class="token operator">=</span> symbol<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>decimals <span class="token operator">=</span> decimals<span class="token punctuation">;</span>
        totalSupply <span class="token operator">=</span> initialAmount<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>TEN<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>decimals<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        balances<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> totalSupply<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TransferEvent</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span> Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> totalSupply<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> BigInteger <span class="token function">allowance</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address owner<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> Address spender<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span> ownerAllowed <span class="token operator">=</span> allowed<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>owner<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ownerAllowed <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        BigInteger value <span class="token operator">=</span> ownerAllowed<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>spender<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            value <span class="token operator">=</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">transferFrom</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address from<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> Address to<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">subtractAllowed</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">subtractBalance</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addBalance</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TransferEvent</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> BigInteger <span class="token function">balanceOf</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address owner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>owner <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
        BigInteger balance <span class="token operator">=</span> balances<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>owner<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>balance <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            balance <span class="token operator">=</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> balance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address to<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">subtractBalance</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addBalance</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TransferEvent</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">approve</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address spender<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setAllowed</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ApprovalEvent</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">increaseApproval</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address spender<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger addedValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">addAllowed</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> addedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ApprovalEvent</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> <span class="token function">allowance</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">decreaseApproval</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address spender<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger subtractedValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">check</span><span class="token punctuation">(</span>subtractedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        BigInteger oldValue <span class="token operator">=</span> <span class="token function">allowance</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>subtractedValue<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>oldValue<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setAllowed</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">subtractAllowed</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> subtractedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ApprovalEvent</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> <span class="token function">allowance</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addAllowed</span><span class="token punctuation">(</span>Address address1<span class="token punctuation">,</span> Address address2<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BigInteger allowance <span class="token operator">=</span> <span class="token function">allowance</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>allowance<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setAllowed</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address2<span class="token punctuation">,</span> allowance<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">subtractAllowed</span><span class="token punctuation">(</span>Address address1<span class="token punctuation">,</span> Address address2<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BigInteger allowance <span class="token operator">=</span> <span class="token function">allowance</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>allowance<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token string">&quot;Insufficient approved token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setAllowed</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address2<span class="token punctuation">,</span> allowance<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">setAllowed</span><span class="token punctuation">(</span>Address address1<span class="token punctuation">,</span> Address address2<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span> address1Allowed <span class="token operator">=</span> allowed<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>address1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>address1Allowed <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            address1Allowed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            allowed<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address1Allowed<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        address1Allowed<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>address2<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addBalance</span><span class="token punctuation">(</span>Address address<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BigInteger balance <span class="token operator">=</span> <span class="token function">balanceOf</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">&quot;The value must be greater than or equal to 0.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
        balances<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> balance<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">subtractBalance</span><span class="token punctuation">(</span>Address address<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BigInteger balance <span class="token operator">=</span> <span class="token function">balanceOf</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>balance<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token string">&quot;Insufficient balance of token.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        balances<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> balance<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>value <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>BigInteger value1<span class="token punctuation">,</span> BigInteger value2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span>value1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>BigInteger value<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>value <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>BigInteger value1<span class="token punctuation">,</span> BigInteger value2<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span>value1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>



<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br></div></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/nuls-io/devsite/edit/dev/docs/zh/smartContract/6-1developerManual.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2018-12-19 13:40:12</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/zh/smartContract/6-8startSmartContract.html" class="prev">
          [快速入门]从0开始NULS智能合约
        </a></span> <span class="next"><a href="/zh/smartContract/6-2GUIForSmartContract.html">
          [快速入门] 智能合约操作手册
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.f0dccc53.js" defer></script><script src="/assets/js/50.bc8b6fb3.js" defer></script>
  </body>
</html>
